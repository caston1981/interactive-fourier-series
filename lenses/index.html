<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Four-Lens System Analysis - Mathematical Transforms Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: A tabbed, single-page application design was chosen for clarity and ease of navigation. The core structure separates each transform into its own dedicated section (Laplace, Fourier, Z) while providing specific sections for 'Interconnections' and 'System Analysis'. This hub-and-spoke model allows users to either study a transform in isolation or directly explore the mathematical relationships between them. Interactive charts for the s-plane and z-plane are central to the experience, allowing users to place poles/zeros and see concepts like stability and Region of Convergence update in real-time. This interactive, non-linear approach is more engaging and pedagogically effective for exploring complex mathematical concepts than a static, linear document. -->
    <!-- Visualization & Content Choices: Report Info -> Goal -> Viz/Presentation Method -> Interaction -> Justification -> Library/Method. 1. Complex Planes (s-plane, z-plane): Goal is to visualize stability and ROC. Method is an interactive scatter plot using Chart.js on a Canvas element. Interaction allows users to click to add/remove poles & zeros, with the chart and explanatory text updating dynamically. This provides immediate feedback on the mathematical consequences of pole-zero placement. 2. Transform Relationships (s to z): Goal is to show the mapping. Method is a side-by-side view of s-plane and z-plane charts (Chart.js/Canvas). Interaction involves sliders to change discretization parameters (e.g., sampling period T), updating the mapped pole locations. This clarifies the mathematical effect of different discretization methods. 3. Mathematical Properties/Theorems: Goal is to present dense information concisely. Method is a grid of expandable cards (HTML/CSS/JS). Interaction is clicking a card to reveal the detailed formula and proof. This avoids overwhelming the user and allows for focused study. All visualizations are on Canvas, confirming NO SVG/Mermaid. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body class="antialiased">
    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-10 shadow-sm border-b border-gray-200">
      <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center">
            <button id="mobile-menu-btn" class="lg:hidden mr-4 p-2 rounded-md text-gray-700 hover:text-gray-900 hover:bg-gray-100">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
            </button>
            <h1 class="text-xl font-bold text-gray-800">Transforms Explorer</h1>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="index.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors"
              >üè† Home</a
            >
            <a
              href="freq-domain.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 transition-colors"
              >Frequency Domain Biology</a
            >
            <a
              href="bio-signal.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-purple-600 hover:text-purple-800 bg-purple-50 hover:bg-purple-100 transition-colors"
              >Biological Signal Analysis</a
            >
            <a
              href="critique.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-slate-800 bg-slate-50 hover:bg-slate-100 transition-colors"
              >Four-Lens Critique</a
            >
            <a
              href="bioxen.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-teal-600 hover:text-teal-800 bg-teal-50 hover:bg-teal-100 transition-colors"
              >BioXen Research Plan</a
            >
            <a
              href="bioxen-lenses.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-orange-600 hover:text-orange-800 bg-orange-50 hover:bg-orange-100 transition-colors"
              >BioXen VM Spec</a
            >
            <a
              href="wavelets.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-amber-600 hover:text-amber-800 bg-amber-50 hover:bg-amber-100 transition-colors"
              >Wavelet Analysis</a
            >
            <a
              href="wavelet-libs.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-cyan-600 hover:text-cyan-800 bg-cyan-50 hover:bg-cyan-100 transition-colors"
              >Wavelet Libraries</a
            >
            <a
              href="bio-lenses.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 transition-colors"
              >Biology Lenses ‚Üí</a
            >
          </div>
        </div>

        <!-- Mobile Navigation Menu -->
        <div id="mobile-menu" class="hidden lg:hidden mt-4 pb-4 border-t border-gray-200">
          <div class="flex flex-col space-y-2 mt-4">
            <a href="index.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors">üè† Home</a>
            <a href="freq-domain.html" class="px-3 py-2 rounded-md text-sm font-medium text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 transition-colors">Frequency Domain Biology</a>
            <a href="bio-signal.html" class="px-3 py-2 rounded-md text-sm font-medium text-purple-600 hover:text-purple-800 bg-purple-50 hover:bg-purple-100 transition-colors">Biological Signal Analysis</a>
            <a href="critique.html" class="px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-slate-800 bg-slate-50 hover:bg-slate-100 transition-colors">Four-Lens Critique</a>
            <a href="bioxen.html" class="px-3 py-2 rounded-md text-sm font-medium text-teal-600 hover:text-teal-800 bg-teal-50 hover:bg-teal-100 transition-colors">BioXen Research Plan</a>
            <a href="bioxen-lenses.html" class="px-3 py-2 rounded-md text-sm font-medium text-orange-600 hover:text-orange-800 bg-orange-50 hover:bg-orange-100 transition-colors">BioXen VM Spec</a>
            <a href="wavelets.html" class="px-3 py-2 rounded-md text-sm font-medium text-amber-600 hover:text-amber-800 bg-amber-50 hover:bg-amber-100 transition-colors">Wavelet Analysis</a>
            <a href="wavelet-libs.html" class="px-3 py-2 rounded-md text-sm font-medium text-cyan-600 hover:text-cyan-800 bg-cyan-50 hover:bg-cyan-100 transition-colors">Wavelet Libraries</a>
            <a href="bio-lenses.html" class="px-3 py-2 rounded-md text-sm font-medium text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 transition-colors">Biology Lenses ‚Üí</a>
          </div>
        </div>
      </nav>
    </header>

    <div class="flex min-h-screen">
      <!-- Mobile Sidebar Toggle -->
      <div class="lg:hidden fixed top-20 left-4 z-20">
        <button id="sidebar-toggle" class="bg-gray-800 text-white p-2 rounded-md shadow-lg">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </div>

      <!-- Left Sidebar Navigation -->
      <aside id="sidebar" class="w-64 bg-gray-50 border-r border-gray-200 p-6 fixed lg:static lg:block hidden lg:translate-x-0 transform -translate-x-full transition-transform duration-300 ease-in-out z-10 lg:z-auto">
        <h2 class="text-lg font-semibold text-gray-800 mb-4">Page Navigation</h2>
        <nav class="space-y-2">
          <a href="#overview" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Overview</a>
          <a href="#fourier" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Fourier Transform</a>
          <a href="#wavelet" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Wavelet Transform</a>
          <a href="#laplace" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Laplace Transform</a>
          <a href="#z-transform" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Z-Transform</a>
          <a href="#interconnections" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Interconnections</a>
          <a href="#analysis" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">System Analysis</a>
        </nav>
        <div class="mt-6 p-3 bg-blue-50 border border-blue-200 rounded-lg">
          <p class="text-xs text-blue-900 font-semibold mb-1">üî¨ Biology Focus</p>
          <p class="text-xs text-blue-800">See <a href="bioxen-lenses.html" class="underline">BioXen Lenses</a> for biological applications</p>
        </div>
      </aside>

      <!-- Overlay for mobile sidebar -->
      <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 lg:hidden hidden z-5" onclick="closeSidebar()"></div>

      <!-- Main Content -->
      <main class="flex-1 p-4 lg:p-8">
      <section id="overview" class="content-section">
        <div class="text-center mb-12">
          <h2
            class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl"
          >
            Four Lenses for System Analysis
          </h2>
          <p class="mt-4 max-w-2xl mx-auto text-lg text-gray-600">
            This application provides a mathematically rigorous exploration of
            four complementary analytical frameworks: Fourier, Wavelet, Laplace, and Z-Transforms. 
            These are not disparate tools, but deeply interconnected lenses for analyzing systems
            from frequency, time-frequency, continuous-time, and discrete-time perspectives. 
            <strong>For biological signals</strong>, the Fourier lens emphasizes the 
            <em>Lomb-Scargle periodogram</em> as the industry standard for irregular sampling, 
            while Wavelets are essential for non-stationary dynamics.
          </p>
          <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg max-w-3xl mx-auto">
            <p class="text-sm text-blue-900">
              <strong>üî¨ For BioXen Applications:</strong> See 
              <a href="bioxen-lenses.html" class="text-blue-700 hover:text-blue-900 underline font-semibold">BioXen VM Spec</a> 
              for the research-enhanced four-lens system with interactive decision trees, biological signal examples, 
              and validation tools specifically designed for circadian rhythms, gene expression, and metabolic oscillations.
            </p>
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div class="card p-6 text-center">
            <div class="text-3xl mb-3">üìä</div>
            <h3 class="text-xl font-semibold mb-2">Fourier Transform</h3>
            <p class="text-gray-600 text-sm">
              The lens for the frequency domain. Decomposes signals into constituent frequencies.
              <strong>Lomb-Scargle variant</strong> is the gold standard in biology for 
              irregularly-sampled data (circadian rhythms, gene expression).
            </p>
          </div>
          <div class="card p-6 text-center">
            <div class="text-3xl mb-3">üåä</div>
            <h3 class="text-xl font-semibold mb-2">Wavelet Transform</h3>
            <p class="text-gray-600 text-sm">
              The lens for time-frequency localization. <strong>Essential</strong> for 
              non-stationary biological signals where frequency content changes over time 
              (transient responses, cell cycle transitions).
            </p>
          </div>
          <div class="card p-6 text-center">
            <div class="text-3xl mb-3">‚ö°</div>
            <h3 class="text-xl font-semibold mb-2">Laplace Transform</h3>
            <p class="text-gray-600 text-sm">
              The lens for continuous-time systems. Analyzes transient behavior, 
              stability, and control of systems described by differential equations 
              (metabolic pathways, regulatory networks).
            </p>
          </div>
          <div class="card p-6 text-center">
            <div class="text-3xl mb-3">üî¢</div>
            <h3 class="text-xl font-semibold mb-2">Z-Transform</h3>
            <p class="text-gray-600 text-sm">
              The lens for discrete-time systems. Essential for digital signal processing 
              and analyzing sampled experimental data from time-series measurements.
            </p>
          </div>
        </div>
        
        <div class="mt-8 p-6 bg-gray-50 border border-gray-200 rounded-lg max-w-4xl mx-auto">
          <h3 class="text-lg font-semibold mb-3 text-gray-800">Why Four Lenses?</h3>
          <ul class="space-y-2 text-sm text-gray-700">
            <li class="flex items-start">
              <span class="mr-2">‚Ä¢</span>
              <span><strong>Biological signals are non-stationary</strong> ‚Äî frequency content changes over time (e.g., cell cycle phases) ‚Üí Wavelet analysis is essential, not optional</span>
            </li>
            <li class="flex items-start">
              <span class="mr-2">‚Ä¢</span>
              <span><strong>Biological sampling is irregular</strong> ‚Äî real-world constraints create uneven time points ‚Üí Lomb-Scargle periodogram is the standard</span>
            </li>
            <li class="flex items-start">
              <span class="mr-2">‚Ä¢</span>
              <span><strong>Different questions require different tools</strong> ‚Äî Stability (Laplace), dominant frequencies (Fourier), transient events (Wavelet), sampled data (Z-Transform)</span>
            </li>
            <li class="flex items-start">
              <span class="mr-2">‚Ä¢</span>
              <span><strong>Multi-lens validation increases confidence</strong> ‚Äî Findings confirmed across multiple analytical frameworks are more robust</span>
            </li>
          </ul>
        </div>
      </section>

      <section id="laplace" class="content-section">
        <h2 class="text-3xl font-bold tracking-tight text-gray-900 mb-6">
          The Laplace Transform
        </h2>
        <p class="mb-8 text-lg text-gray-600">
          The Laplace Transform converts a function of a real variable ùë° (often
          time) to a function of a complex variable ùë† (complex frequency). This
          transformation is invaluable for solving linear ordinary differential
          equations, where it converts differentiation and integration into
          algebraic multiplication and division, simplifying analysis
          significantly. The key to its power is the s-plane, a complex plane
          where system characteristics like stability and response can be
          visualized geometrically.
        </p>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Interactive s-Plane</h3>
            <p class="mb-4 text-sm text-gray-600">
              Click on the chart to place poles (X) and see how their location
              affects system stability. The Region of Convergence (ROC) will be
              shaded, and the stability determined. Poles in the left-half plane
              result in a stable system.
            </p>
            <div class="chart-container">
              <canvas id="sPlaneChart"></canvas>
            </div>
            <div id="sPlaneInfo" class="mt-4 p-4 bg-gray-50 rounded-lg">
              <p class="font-semibold">System Properties:</p>
              <p id="sPlaneStability" class="text-gray-700">
                No poles placed yet.
              </p>
              <button
                id="clearSPlane"
                class="mt-2 px-3 py-1 text-sm bg-red-500 text-white rounded-md hover:bg-red-600"
              >
                Clear Poles
              </button>
            </div>
          </div>
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Foundational Definitions</h3>
            <h4 class="font-semibold mt-4">Bilateral Laplace Transform</h4>
            <p class="formula">
              ‚Ñí{f(t)} = F(s) = ‚à´<sub>-‚àû</sub><sup>‚àû</sup> f(t)e<sup>-st</sup> dt
            </p>
            <h4 class="font-semibold mt-4">Unilateral Laplace Transform</h4>
            <p class="formula">
              ‚Ñí{f(t)} = F(s) = ‚à´<sub>0</sub><sup>‚àû</sup> f(t)e<sup>-st</sup> dt
            </p>
            <p class="mt-2 text-gray-600">
              Here, ùë† is a complex variable, ùë† = œÉ + jœâ. The transform exists if
              the integral converges. This convergence depends on œÉ and defines
              the Region of Convergence (ROC).
            </p>

            <h4 class="font-semibold mt-6">Inverse Laplace Transform</h4>
            <p class="formula">
              f(t) = ‚Ñí<sup>-1</sup>{F(s)} = (1/2œÄj) ‚à´<sub>Œ≥-j‚àû</sub
              ><sup>Œ≥+j‚àû</sup> F(s)e<sup>st</sup> ds
            </p>
            <p class="mt-2 text-gray-600">
              This is the Bromwich integral, a contour integral in the complex
              s-plane where Œ≥ is chosen to be within the ROC.
            </p>
          </div>
        </div>
      </section>

      <section id="fourier" class="content-section">
        <h2 class="text-3xl font-bold tracking-tight text-gray-900 mb-6">
          The Fourier Transform
        </h2>
        <p class="mb-8 text-lg text-gray-600">
          The Fourier Transform provides a frequency-domain representation of a
          time-domain signal. It is a special case of the Laplace Transform
          where the complex frequency variable ùë† is restricted to the imaginary
          axis (ùë† = jœâ). This tool is fundamental in signal processing, as it
          allows us to analyze the frequency components present in a signal,
          which is crucial for tasks like filtering, modulation, and spectral
          analysis. The transform exists for signals that satisfy certain
          conditions, such as having finite energy.
        </p>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Interactive Magnitude and Phase Response</h3>
            <p class="mb-4 text-sm text-gray-600">Adjust the system parameters to see how they affect the frequency response. A system's frequency response H(jœâ) is typically complex, with magnitude and phase components shown below (Bode plots).</p>
            
            <div class="mb-4 space-y-3">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        Natural Frequency (œâ‚Çô) = <span id="wnValue" class="text-gray-900 font-semibold">2.0</span> rad/s
                    </label>
                    <input type="range" id="wnSlider" min="0.5" max="5" step="0.1" value="2" class="w-full">
                    <p class="text-xs text-gray-500 mt-1">Controls the system's speed of response</p>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">
                        Damping Ratio (Œ∂) = <span id="zetaValue" class="text-gray-900 font-semibold">0.50</span>
                    </label>
                    <input type="range" id="zetaSlider" min="0.1" max="2.0" step="0.05" value="0.5" class="w-full">
                    <p class="text-xs text-gray-500 mt-1">Controls oscillation: &lt;1 underdamped, =1 critically damped, &gt;1 overdamped</p>
                </div>
                
                <div class="formula text-center" id="transferFunction">
                    H(s) = 4.00 / (s¬≤ + 2.00s + 4.00)
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="bodePlotChart"></canvas>
            </div>
          </div>
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Foundational Definitions</h3>
            <h4 class="font-semibold mt-4">Continuous Fourier Transform</h4>
            <p class="formula">
              ‚Ñ±{f(t)} = F(jœâ) = ‚à´<sub>-‚àû</sub><sup>‚àû</sup> f(t)e<sup>-jœât</sup>
              dt
            </p>
            <h4 class="font-semibold mt-4">Inverse Fourier Transform</h4>
            <p class="formula">
              f(t) = ‚Ñ±<sup>-1</sup>{F(jœâ)} = (1/2œÄ) ‚à´<sub>-‚àû</sub
              ><sup>‚àû</sup> F(jœâ)e<sup>jœât</sup> dœâ
            </p>
            <p class="mt-2 text-gray-600">
              The transform pair exists if f(t) satisfies the Dirichlet
              conditions (e.g., is absolutely integrable).
            </p>
            <h4 class="font-semibold mt-6">
              Plancherel's Theorem (Energy Conservation)
            </h4>
            <p class="formula">
              ‚à´<sub>-‚àû</sub><sup>‚àû</sup> |f(t)|¬≤ dt = (1/2œÄ) ‚à´<sub>-‚àû</sub
              ><sup>‚àû</sup> |F(jœâ)|¬≤ dœâ
            </p>
            <p class="mt-2 text-gray-600">
              This theorem states that the total energy of a signal is the same
              whether calculated in the time domain or the frequency domain.
            </p>
          </div>
        </div>
      </section>

      <section id="wavelet" class="content-section">
        <h2 class="text-3xl font-bold tracking-tight text-gray-900 mb-6">
          The Wavelet Transform
        </h2>
        <p class="mb-8 text-lg text-gray-600">
          The Wavelet Transform provides simultaneous time and frequency information, 
          making it ideal for analyzing <strong>non-stationary signals</strong> where 
          frequency content changes over time. Unlike the Fourier Transform which gives 
          global frequency information, wavelets use localized basis functions that can 
          capture transient features, discontinuities, and time-varying behavior. 
          This is <strong>essential in biology</strong> where conditions constantly change 
          (cell cycle phases, stimulus responses, developmental transitions).
        </p>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Continuous Wavelet Transform (CWT)</h3>
            <p class="mb-4 text-gray-600">
              The CWT analyzes a signal at multiple scales (frequencies) and positions (time),
              creating a time-frequency representation that shows how frequency content evolves.
            </p>
            
            <h4 class="font-semibold mt-4">CWT Definition</h4>
            <p class="formula">
              CWT<sub>f</sub>(a,b) = (1/‚àö|a|) ‚à´<sub>-‚àû</sub><sup>‚àû</sup> f(t)œà*((t-b)/a) dt
            </p>
            <p class="mt-2 text-sm text-gray-600">
              Where <strong>a</strong> is the scale parameter (related to frequency: high scale = low frequency),
              <strong>b</strong> is the translation (time position), and <strong>œà</strong> is the mother wavelet.
            </p>

            <h4 class="font-semibold mt-6">Common Mother Wavelets</h4>
            <ul class="text-sm text-gray-700 space-y-2 mt-2">
              <li><strong>Morlet:</strong> Complex exponential with Gaussian envelope - excellent for frequency analysis</li>
              <li><strong>Mexican Hat (Ricker):</strong> Second derivative of Gaussian - good for edge detection</li>
              <li><strong>Daubechies (db4, db8):</strong> Compact support, orthogonal - DWT applications</li>
              <li><strong>Haar:</strong> Simplest wavelet - fast computation, step detection</li>
            </ul>
          </div>

          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Biological Applications</h3>
            
            <div class="p-4 bg-green-50 border border-green-200 rounded-lg mb-4">
              <h4 class="font-semibold text-green-900 mb-2">üî¨ Why Wavelets for Biology?</h4>
              <ul class="text-sm text-green-800 space-y-1">
                <li>‚úì Cell cycle transitions (G1‚ÜíS‚ÜíG2‚ÜíM phases)</li>
                <li>‚úì Stimulus-response dynamics (drug effects, stress)</li>
                <li>‚úì Developmental stages (embryogenesis, differentiation)</li>
                <li>‚úì Transient events (calcium spikes, action potentials)</li>
                <li>‚úì Circadian disruptions (jet lag, shift work effects)</li>
              </ul>
            </div>

            <h4 class="font-semibold mt-4">Discrete Wavelet Transform (DWT)</h4>
            <p class="formula">
              DWT: c<sub>j,k</sub> = ‚à´ f(t)œà<sub>j,k</sub>(t) dt
            </p>
            <p class="mt-2 text-sm text-gray-600">
              where œà<sub>j,k</sub>(t) = 2<sup>-j/2</sup> œà(2<sup>-j</sup>t - k) are discretized wavelets
              at scale j and position k. DWT is computationally efficient and used for signal decomposition.
            </p>

            <h4 class="font-semibold mt-6">Python Implementation</h4>
            <div class="code-block text-xs">
import pywt<br/>
import numpy as np<br/>
<br/>
# Example: Analyze cell cycle gene expression<br/>
time = np.linspace(0, 48, 200)  # 48 hours<br/>
signal = gene_expression_data<br/>
<br/>
# Continuous Wavelet Transform<br/>
scales = np.arange(1, 128)<br/>
coef, freqs = pywt.cwt(signal, scales, 'morl')<br/>
<br/>
# Result: Time-frequency heatmap showing<br/>
# when specific oscillations occur
            </div>
          </div>
        </div>

        <div class="mt-6 p-4 bg-purple-50 border border-purple-200 rounded-lg">
          <h4 class="font-semibold text-purple-900 mb-2">üìö Key Properties & Advantages</h4>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-purple-800">
            <div>
              <p class="font-semibold">Localization:</p>
              <ul class="ml-4 mt-1 space-y-1">
                <li>‚Ä¢ Time: Identifies <em>when</em> events occur</li>
                <li>‚Ä¢ Frequency: Identifies <em>what</em> frequencies are present</li>
              </ul>
            </div>
            <div>
              <p class="font-semibold">Multi-resolution:</p>
              <ul class="ml-4 mt-1 space-y-1">
                <li>‚Ä¢ Zooms in on high-frequency details</li>
                <li>‚Ä¢ Captures low-frequency trends</li>
              </ul>
            </div>
            <div>
              <p class="font-semibold">Adaptivity:</p>
              <ul class="ml-4 mt-1 space-y-1">
                <li>‚Ä¢ Choose mother wavelet for signal type</li>
                <li>‚Ä¢ Adjust scales for frequency range</li>
              </ul>
            </div>
            <div>
              <p class="font-semibold">Compared to Fourier:</p>
              <ul class="ml-4 mt-1 space-y-1">
                <li>‚Ä¢ Fourier: Global frequency, no time info</li>
                <li>‚Ä¢ Wavelet: Local time-frequency maps</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section id="z-transform" class="content-section">
        <h2 class="text-3xl font-bold tracking-tight text-gray-900 mb-6">
          The Z-Transform
        </h2>
        <p class="mb-8 text-lg text-gray-600">
          The Z-Transform is the discrete-time equivalent of the Laplace
          Transform. It converts a discrete-time signal, which is a sequence of
          numbers, into a function of a complex variable ùëß. This is the
          cornerstone of digital signal processing and control, allowing
          engineers to analyze and design digital filters and control systems
          using algebraic methods similar to those used in continuous-time
          systems. System properties are determined by pole-zero locations
          relative to the unit circle in the complex z-plane.
        </p>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Interactive z-Plane</h3>
            <p class="mb-4 text-sm text-gray-600">
              Click on the chart to place poles (X). A discrete-time system is
              stable if all its poles lie inside the unit circle. Observe how
              the stability changes as you move poles across the unit circle
              boundary.
            </p>
            <div class="chart-container">
              <canvas id="zPlaneChart"></canvas>
            </div>
            <div id="zPlaneInfo" class="mt-4 p-4 bg-gray-50 rounded-lg">
              <p class="font-semibold">System Properties:</p>
              <p id="zPlaneStability" class="text-gray-700">
                No poles placed yet.
              </p>
              <button
                id="clearZPlane"
                class="mt-2 px-3 py-1 text-sm bg-red-500 text-white rounded-md hover:bg-red-600"
              >
                Clear Poles
              </button>
            </div>
          </div>
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Foundational Definitions</h3>
            <h4 class="font-semibold mt-4">Z-Transform Definition</h4>
            <p class="formula">
              Z{x[n]} = X(z) = Œ£<sub>n=-‚àû</sub><sup>‚àû</sup> x[n]z<sup>-n</sup>
            </p>
            <p class="mt-2 text-gray-600">
              Where ùëß is a complex variable. The series converges for values of
              ùëß in the Region of Convergence (ROC), which is typically an
              annulus in the z-plane.
            </p>

            <h4 class="font-semibold mt-6">Inverse Z-Transform</h4>
            <p class="formula">
              x[n] = Z<sup>-1</sup>{X(z)} = (1/2œÄj) ‚àÆ<sub>C</sub> X(z)z<sup
                >n-1</sup
              >
              dz
            </p>
            <p class="mt-2 text-gray-600">
              This is a contour integral around a counter-clockwise path C that
              lies within the ROC and encloses the origin.
            </p>
          </div>
        </div>
      </section>

      <section id="interconnections" class="content-section">
        <h2 class="text-3xl font-bold tracking-tight text-gray-900 mb-6">
          Mathematical Interconnections
        </h2>
        <p class="mb-8 text-lg text-gray-600">
          The four transforms are not isolated concepts; they are
          mathematically linked. The <strong>Fourier Transform</strong> is a special case of the
          Laplace Transform (restricting s to the imaginary axis). The <strong>Wavelet Transform</strong>
          extends Fourier analysis by introducing localized time-frequency basis functions instead of 
          global sinusoids. The <strong>Z-Transform</strong> arises from the Laplace Transform
          through discretization (z = e<sup>sT</sup>). Understanding these connections provides a
          unified view of system analysis, allowing one to choose the right lens for the signal
          characteristics (stationary vs. non-stationary, continuous vs. discrete, regular vs. irregular sampling).
        </p>
        
        <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg mb-6">
          <h4 class="font-semibold text-blue-900 mb-2">üîó Key Relationships</h4>
          <ul class="text-sm text-blue-800 space-y-1">
            <li><strong>Fourier ‚äÇ Laplace:</strong> Setting s = jœâ in Laplace gives Fourier (frequency domain only)</li>
            <li><strong>Wavelet extends Fourier:</strong> Trades frequency resolution for time localization</li>
            <li><strong>Z-Transform from Laplace:</strong> Discrete-time equivalent via z = e<sup>sT</sup> mapping</li>
            <li><strong>Multi-lens validation:</strong> Use multiple transforms to confirm findings and gain complementary insights</li>
          </ul>
        </div>

        <div class="card p-6">
          <h3 class="text-xl font-semibold mb-2">
            From Continuous (s-plane) to Discrete (z-plane)
          </h3>
          <p class="mb-4 text-gray-600">
            Discretization methods provide a mathematical mapping from the
            s-plane to the z-plane. This is crucial for designing digital
            controllers for analog systems. Below, you can see how a pole in the
            s-plane is mapped to the z-plane using different approximations. The
            Bilinear Transform is notable because it maps the entire stable
            left-half of the s-plane uniquely inside the unit circle of the
            z-plane, preserving stability.
          </p>

          <div class="mb-4 flex justify-center space-x-2">
            <button
              id="btn-forward-euler"
              class="tab-button px-4 py-2 text-sm rounded-md bg-gray-200"
            >
              Forward Euler
            </button>
            <button
              id="btn-backward-euler"
              class="tab-button px-4 py-2 text-sm rounded-md bg-gray-200"
            >
              Backward Euler
            </button>
            <button
              id="btn-bilinear"
              class="tab-button px-4 py-2 text-sm rounded-md bg-gray-200 active"
            >
              Bilinear (Tustin)
            </button>
          </div>

          <div id="mapping-formula-container" class="my-4 text-center">
            <p class="formula" id="mapping-formula"></p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
            <div>
              <h4 class="text-center font-semibold mb-2">
                s-plane (Click to place a pole)
              </h4>
              <div class="chart-container">
                <canvas id="sPlaneMappingChart"></canvas>
              </div>
            </div>
            <div>
              <h4 class="text-center font-semibold mb-2">
                z-plane (Result of mapping)
              </h4>
              <div class="chart-container">
                <canvas id="zPlaneMappingChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="analysis" class="content-section">
        <h2 class="text-3xl font-bold tracking-tight text-gray-900 mb-6">
          Applications in System Analysis
        </h2>
        <p class="mb-8 text-lg text-gray-600">
          Transforms provide the mathematical machinery to define and analyze
          key system properties like transfer functions and stability. A
          transfer function, expressed in the s-domain or z-domain, is a compact
          representation of a system's dynamics, derived directly from its
          governing differential or difference equation. The locations of the
          transfer function's poles and zeros in the complex plane dictate the
          system's behavior entirely.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Transfer Functions</h3>
            <p class="text-gray-600 mb-4">
              A transfer function H(s) or H(z) is the ratio of the output
              transform to the input transform, assuming zero initial
              conditions.
            </p>
            <h4 class="font-semibold">Continuous System (LTI)</h4>
            <p class="text-gray-600">
              From a differential equation like my'' + cy' + ky = f(t):
            </p>
            <p class="formula">H(s) = Y(s)/F(s) = 1 / (ms¬≤ + cs + k)</p>
            <h4 class="font-semibold mt-4">Discrete System</h4>
            <p class="text-gray-600">
              From a difference equation like y[n] = ay[n-1] + bx[n]:
            </p>
            <p class="formula">H(z) = Y(z)/X(z) = b / (1 - az‚Åª¬π)</p>
          </div>
          <div class="card p-6">
            <h3 class="text-xl font-semibold mb-4">Stability Criteria</h3>
            <p class="text-gray-600 mb-4">
              Stability is a critical property of a system. Using transforms, it
              can be determined directly from the transfer function's pole
              locations.
            </p>
            <ul>
              <li class="mb-2">
                <strong class="text-gray-800">Laplace Domain:</strong> A
                continuous-time LTI system is Bounded-Input Bounded-Output
                (BIBO) stable if and only if all poles of its transfer function
                H(s) have negative real parts (i.e., they lie in the left-half
                of the s-plane).
              </li>
              <li class="mt-4">
                <strong class="text-gray-800">Z-Domain:</strong> A discrete-time
                LTI system is BIBO stable if and only if all poles of its
                transfer function H(z) have a magnitude less than 1 (i.e., they
                lie inside the unit circle in the z-plane).
              </li>
            </ul>
          </div>
        </div>
      </section>
    </main>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const navLinks = document.querySelectorAll(".sidebar-nav-link");
        const sections = document.querySelectorAll(".content-section");

        function updateActiveState() {
          const hash = window.location.hash || "#overview";

          navLinks.forEach((link) => {
            if (link.getAttribute("href") === hash) {
              link.classList.add("active", "bg-gray-200");
            } else {
              link.classList.remove("active", "bg-gray-200");
            }
          });

          sections.forEach((section) => {
            if ("#" + section.id === hash) {
              section.classList.add("active");
            } else {
              section.classList.remove("active");
            }
          });
        }

        navLinks.forEach((link) => {
          link.addEventListener("click", (e) => {
            setTimeout(() => updateActiveState(), 0);
          });
        });

        window.addEventListener("hashchange", updateActiveState);
        updateActiveState();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuBtn.addEventListener('click', () => {
          mobileMenu.classList.toggle('hidden');
        });

        // Mobile sidebar toggle
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebar-overlay');

        function openSidebar() {
          sidebar.classList.remove('-translate-x-full');
          sidebarOverlay.classList.remove('hidden');
        }

        function closeSidebar() {
          sidebar.classList.add('-translate-x-full');
          sidebarOverlay.classList.add('hidden');
        }

        sidebarToggle.addEventListener('click', () => {
          if (sidebar.classList.contains('-translate-x-full')) {
            openSidebar();
          } else {
            closeSidebar();
          }
        });

        // Close sidebar when clicking on a nav link (mobile)
        document.querySelectorAll('.sidebar-nav-link').forEach(link => {
          link.addEventListener('click', () => {
            if (window.innerWidth < 1024) { // lg breakpoint
              closeSidebar();
            }
          });
        });

        let sPlaneChart,
          zPlaneChart,
          bodePlotChart,
          sPlaneMappingChart,
          zPlaneMappingChart;
        let sPlanePoles = [],
          zPlanePoles = [],
          sMappingPole = null;

        const chartDefaultOptions = {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            x: {
              min: -5,
              max: 5,
              title: { display: true, text: "Re" },
              grid: { color: "#e0e0e0" },
            },
            y: {
              min: -5,
              max: 5,
              title: { display: true, text: "Im" },
              grid: { color: "#e0e0e0" },
            },
          },
        };

        function createComplexPlane(ctx, axisLabels, limits) {
          return new Chart(ctx, {
            type: "scatter",
            data: { datasets: [] },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: false },
                tooltip: { enabled: false },
              },
              scales: {
                x: {
                  min: limits.x[0],
                  max: limits.x[1],
                  title: { display: true, text: axisLabels.x },
                  grid: { color: "#eee" },
                  ticks: { stepSize: 1 },
                },
                y: {
                  min: limits.y[0],
                  max: limits.y[1],
                  title: { display: true, text: axisLabels.y },
                  grid: { color: "#eee" },
                  ticks: { stepSize: 1 },
                },
              },
              animation: { duration: 0 },
            },
          });
        }

        function drawSPlane(chart, poles) {
          const datasets = [
            {
              label: "Poles",
              data: poles,
              pointStyle: "crossRot",
              radius: 10,
              borderColor: "red",
              backgroundColor: "red",
              borderWidth: 3,
            },
          ];

          let rocDataset = {};
          const maxRealPart =
            poles.length > 0 ? Math.max(...poles.map((p) => p.x)) : -Infinity;

          if (isFinite(maxRealPart)) {
            rocDataset = {
              type: "bar",
              label: "ROC",
              data: [
                {
                  x: (5 + maxRealPart) / 2,
                  y: 0,
                  _custom: { width: 5 - maxRealPart, height: 10 },
                },
              ],
              backgroundColor: "rgba(0, 128, 0, 0.1)",
              borderColor: "rgba(0, 128, 0, 0.3)",
              borderWidth: 1,
              barPercentage: 1.0,
              categoryPercentage: 1.0,
              parsing: false,
            };
            chart.options.plugins.tooltip = { enabled: false };
            chart.options.scales.x.afterBuildTicks = (scale) => {
              scale.min = -5;
              scale.max = 5;
            };
            chart.data.datasets = [rocDataset, ...datasets];
          } else {
            chart.data.datasets = datasets;
          }

          chart.update();
        }

        function checkSPlaneStability(poles) {
          const infoElem = document.getElementById("sPlaneStability");
          if (poles.length === 0) {
            infoElem.textContent = "No poles placed yet.";
            return;
          }
          const isStable = poles.every((p) => p.x < 0);
          const isMarginallyStable =
            !isStable &&
            poles.every((p) => p.x <= 0) &&
            poles.filter((p) => p.x === 0).length > 0;

          if (isStable) {
            infoElem.textContent =
              "Stable: All poles are in the Left-Half Plane.";
            infoElem.style.color = "green";
          } else if (isMarginallyStable) {
            infoElem.textContent =
              "Marginally Stable: One or more poles on the jœâ-axis.";
            infoElem.style.color = "#DAA520";
          } else {
            infoElem.textContent =
              "Unstable: One or more poles are in the Right-Half Plane.";
            infoElem.style.color = "red";
          }
        }

        function initSPlane() {
          const ctx = document.getElementById("sPlaneChart").getContext("2d");
          sPlaneChart = createComplexPlane(
            ctx,
            { x: "œÉ (Real)", y: "jœâ (Imaginary)" },
            { x: [-5, 5], y: [-5, 5] }
          );

          ctx.canvas.addEventListener("click", (evt) => {
            const rect = ctx.canvas.getBoundingClientRect();
            const x = sPlaneChart.scales.x.getValueForPixel(
              evt.clientX - rect.left
            );
            const y = sPlaneChart.scales.y.getValueForPixel(
              evt.clientY - rect.top
            );
            sPlanePoles.push({ x: x, y: y });
            drawSPlane(sPlaneChart, sPlanePoles);
            checkSPlaneStability(sPlanePoles);
          });

          document
            .getElementById("clearSPlane")
            .addEventListener("click", () => {
              sPlanePoles = [];
              drawSPlane(sPlaneChart, sPlanePoles);
              checkSPlaneStability(sPlanePoles);
            });
        }

        function drawZPlane(chart, poles) {
          const unitCircle = [];
          for (let i = 0; i <= 360; i++) {
            const angle = (i * Math.PI) / 180;
            unitCircle.push({ x: Math.cos(angle), y: Math.sin(angle) });
          }

          chart.data.datasets = [
            {
              label: "Unit Circle",
              data: unitCircle,
              borderColor: "#4A4A4A",
              borderWidth: 2,
              pointRadius: 0,
              showLine: true,
              fill: false,
              tension: 0.1,
            },
            {
              label: "Poles",
              data: poles,
              pointStyle: "crossRot",
              radius: 10,
              borderColor: "red",
              backgroundColor: "red",
              borderWidth: 3,
            },
          ];
          chart.update();
        }

        function checkZPlaneStability(poles) {
          const infoElem = document.getElementById("zPlaneStability");
          if (poles.length === 0) {
            infoElem.textContent = "No poles placed yet.";
            return;
          }
          const isStable = poles.every(
            (p) => Math.sqrt(p.x * p.x + p.y * p.y) < 1
          );
          const isMarginallyStable =
            !isStable &&
            poles.every((p) => Math.sqrt(p.x * p.x + p.y * p.y) <= 1);

          if (isStable) {
            infoElem.textContent =
              "Stable: All poles are inside the unit circle.";
            infoElem.style.color = "green";
          } else if (isMarginallyStable) {
            infoElem.textContent =
              "Marginally Stable: One or more poles on the unit circle.";
            infoElem.style.color = "#DAA520";
          } else {
            infoElem.textContent =
              "Unstable: One or more poles are outside the unit circle.";
            infoElem.style.color = "red";
          }
        }

        function initZPlane() {
          const ctx = document.getElementById("zPlaneChart").getContext("2d");
          zPlaneChart = createComplexPlane(
            ctx,
            { x: "Re(z)", y: "Im(z)" },
            { x: [-2, 2], y: [-2, 2] }
          );
          drawZPlane(zPlaneChart, zPlanePoles);

          ctx.canvas.addEventListener("click", (evt) => {
            const rect = ctx.canvas.getBoundingClientRect();
            const x = zPlaneChart.scales.x.getValueForPixel(
              evt.clientX - rect.left
            );
            const y = zPlaneChart.scales.y.getValueForPixel(
              evt.clientY - rect.top
            );
            zPlanePoles.push({ x: x, y: y });
            drawZPlane(zPlaneChart, zPlanePoles);
            checkZPlaneStability(zPlanePoles);
          });

          document
            .getElementById("clearZPlane")
            .addEventListener("click", () => {
              zPlanePoles = [];
              drawZPlane(zPlaneChart, zPlanePoles);
              checkZPlaneStability(zPlanePoles);
            });
        }

        function initBodePlot() {
          const ctx = document.getElementById("bodePlotChart").getContext("2d");
          let wn = 2;
          let zeta = 0.5;

          function calculateBodePlot(wn, zeta) {
            const omega = Array.from(
              { length: 100 },
              (_, i) => 0.1 * Math.pow(1.1, i)
            );
            const mag = omega.map(
              (w) =>
                20 *
                Math.log10(
                  (wn * wn) /
                    Math.sqrt(
                      Math.pow(wn * wn - w * w, 2) +
                        Math.pow(2 * zeta * wn * w, 2)
                    )
                )
            );
            const phase = omega.map(
              (w) =>
                (-Math.atan2(2 * zeta * wn * w, wn * wn - w * w) * 180) /
                Math.PI
            );
            return { omega, mag, phase };
          }

          const initialData = calculateBodePlot(wn, zeta);

          bodePlotChart = new Chart(ctx, {
            type: "line",
            data: {
              labels: initialData.omega,
              datasets: [
                {
                  label: "Magnitude (dB)",
                  data: initialData.mag,
                  borderColor: "#A0522D",
                  backgroundColor: "transparent",
                  yAxisID: "y",
                  borderWidth: 2,
                },
                {
                  label: "Phase (deg)",
                  data: initialData.phase,
                  borderColor: "#4682B4",
                  backgroundColor: "transparent",
                  yAxisID: "y1",
                  borderWidth: 2,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                x: {
                  type: "logarithmic",
                  title: { display: true, text: "Frequency (rad/s)" },
                  grid: { color: "#eee" },
                },
                y: {
                  type: "linear",
                  position: "left",
                  title: { display: true, text: "Magnitude (dB)" },
                  grid: { color: "#eee" },
                },
                y1: {
                  type: "linear",
                  position: "right",
                  title: { display: true, text: "Phase (deg)" },
                  grid: { drawOnChartArea: false },
                },
              },
            },
          });

          // Add event listeners for sliders
          const wnSlider = document.getElementById("wnSlider");
          const zetaSlider = document.getElementById("zetaSlider");
          const wnValue = document.getElementById("wnValue");
          const zetaValue = document.getElementById("zetaValue");
          const transferFunction = document.getElementById("transferFunction");

          function updateBodePlot() {
            wn = parseFloat(wnSlider.value);
            zeta = parseFloat(zetaSlider.value);

            wnValue.textContent = wn.toFixed(1);
            zetaValue.textContent = zeta.toFixed(2);

            // Update transfer function display
            transferFunction.innerHTML = `H(s) = ${(wn * wn).toFixed(
              2
            )} / (s¬≤ + ${(2 * zeta * wn).toFixed(2)}s + ${(wn * wn).toFixed(
              2
            )})`;

            const data = calculateBodePlot(wn, zeta);
            bodePlotChart.data.labels = data.omega;
            bodePlotChart.data.datasets[0].data = data.mag;
            bodePlotChart.data.datasets[1].data = data.phase;
            bodePlotChart.update();
          }

          wnSlider.addEventListener("input", updateBodePlot);
          zetaSlider.addEventListener("input", updateBodePlot);

          // Initialize display
          updateBodePlot();
        }

        function initMapping() {
          const sCtx = document
            .getElementById("sPlaneMappingChart")
            .getContext("2d");
          const zCtx = document
            .getElementById("zPlaneMappingChart")
            .getContext("2d");
          let currentMethod = "bilinear";
          const T = 0.5;

          sPlaneMappingChart = createComplexPlane(
            sCtx,
            { x: "œÉ", y: "jœâ" },
            { x: [-4, 4], y: [-4, 4] }
          );
          zPlaneMappingChart = createComplexPlane(
            zCtx,
            { x: "Re(z)", y: "Im(z)" },
            { x: [-2, 2], y: [-2, 2] }
          );
          drawZPlane(zPlaneMappingChart, []);

          function mapPole(s) {
            if (!s) return null;
            const s_real = s.x;
            const s_imag = s.y;
            let z_real, z_imag;

            if (currentMethod === "forward-euler") {
              z_real = 1 + T * s_real;
              z_imag = T * s_imag;
            } else if (currentMethod === "backward-euler") {
              const den = Math.pow(1 - T * s_real, 2) + Math.pow(T * s_imag, 2);
              z_real = (1 - T * s_real) / den;
              z_imag = (T * s_imag) / den;
            } else {
              // bilinear
              const den =
                Math.pow(1 - (s_real * T) / 2, 2) +
                Math.pow((s_imag * T) / 2, 2);
              z_real =
                (1 - Math.pow(T / 2, 2) * (s_real * s_real + s_imag * s_imag)) /
                den;
              z_imag = (T * s_imag) / den;
            }
            return { x: z_real, y: z_imag };
          }

          function updateMapping() {
            drawSPlane(sPlaneMappingChart, sMappingPole ? [sMappingPole] : []);
            const zPole = mapPole(sMappingPole);
            drawZPlane(zPlaneMappingChart, zPole ? [zPole] : []);
            updateFormula();
          }

          function updateFormula() {
            const formulaEl = document.getElementById("mapping-formula");
            if (currentMethod === "forward-euler") {
              formulaEl.innerHTML = "z ‚âà 1 + sT";
            } else if (currentMethod === "backward-euler") {
              formulaEl.innerHTML = "s ‚âà (1 - z<sup>-1</sup>)/T";
            } else {
              // bilinear
              formulaEl.innerHTML =
                "s ‚âà (2/T) &middot; ( (1 - z<sup>-1</sup>) / (1 + z<sup>-1</sup>) )";
            }
          }

          sCtx.canvas.addEventListener("click", (evt) => {
            const rect = sCtx.canvas.getBoundingClientRect();
            const x = sPlaneMappingChart.scales.x.getValueForPixel(
              evt.clientX - rect.left
            );
            const y = sPlaneMappingChart.scales.y.getValueForPixel(
              evt.clientY - rect.top
            );
            sMappingPole = { x, y };
            updateMapping();
          });

          const buttons = document.querySelectorAll(
            "#interconnections .tab-button"
          );
          buttons.forEach((button) => {
            button.addEventListener("click", () => {
              buttons.forEach((btn) => btn.classList.remove("active"));
              button.classList.add("active");
              currentMethod = button.id.replace("btn-", "");
              updateMapping();
            });
          });

          updateMapping();
        }

        initSPlane();
        initZPlane();
        initBodePlot();
        initMapping();
      });
    </script>
  </body>
</html>
