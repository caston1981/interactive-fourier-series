<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Four-Lens System: Mathematical Transforms in Biology</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .sidebar-open {
            transform: translateX(0);
        }
        #main-content.sidebar-open {
            margin-left: 16rem; /* 256px = w-64 */
        }
        @media (min-width: 1024px) {
            #main-content.sidebar-open {
                margin-left: 0;
            }
        }
    </style>
    <!-- Chosen Palette: Calm Neutrals -->
    <!-- Application Structure Plan: The application is structured as a single-page, tabbed interface to facilitate non-linear exploration. The core content is divided into sections for each of the four transforms (Fourier, Wavelet, Laplace, Z-Transform), followed by sections for Synthesis, Practical Challenges, and a final Critical Conclusion. This thematic structure, rather than a linear report format, allows users to easily compare the transforms or dive deep into a specific area of interest. The user flow is guided by a persistent top navigation bar. Interactive elements like charts and expandable sections are used within each tab to break down complex information and maintain user engagement, directly addressing the user's need to understand both the theory and practical application of each method. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Fourier analysis of biological rhythms (Lomb-Scargle for irregular sampling). Goal: Illustrate frequency decomposition. Viz: Interactive Chart.js line chart (time-series signal) and bar chart (frequency spectrum). Interaction: A button triggers the "analysis," transforming the time-domain view to the frequency-domain view. Justification: This provides a clear, visual demonstration of the Fourier Transform's core function. Library: Chart.js (Canvas).
        - Report Info: Wavelet analysis for non-stationary signals. Goal: Show time-frequency localization. Viz: Interactive visualization showing how wavelets capture transient events that Fourier misses. Justification: Essential for biological signals where frequency changes over time. Method: Chart.js/HTML.
        - Report Info: System modeling with Laplace. Goal: Explain system stability concepts. Presentation: HTML/CSS diagram of a feedback loop. Interaction: Hover effects on diagram components to show tooltips with explanations of 'input', 'system', and 'output'. Justification: Avoids a static image, making the abstract concept of a control system more tangible and explorable. Method: HTML/Tailwind.
        - Report Info: Discrete vs. Continuous data for Z-Transform. Goal: Visualize the concept of sampling. Presentation: A toggle that switches between a smooth line (representing a continuous process) and discrete points on that line. Interaction: User clicks a button to toggle views. Justification: Directly illustrates the fundamental difference in data types that necessitates the Z-Transform, which is a core concept for the user to grasp. Method: Chart.js/HTML.
        - Report Info: Comparing the four transforms. Goal: Provide a quick reference. Presentation: A structured HTML table. Interaction: Clean, readable layout. Justification: A table is the most effective way to present comparative data clearly and concisely. Method: HTML/Tailwind.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
<link rel="stylesheet" href="css/styles.css" />    
</head>
<body class="antialiased flex flex-col min-h-screen">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-10 shadow-sm border-b border-gray-200">
      <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center">
            <h1 class="text-xl font-bold text-blue-700">Biology Lenses</h1>
          </div>
          <div class="hidden md:flex items-center space-x-4">
            <a
              href="index.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors"
              >üè† Home</a
            >
            <a
              href="freq-domain.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 transition-colors"
              >Frequency Domain Biology</a
            >
            <a
              href="bio-signal.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-purple-600 hover:text-purple-800 bg-purple-50 hover:bg-purple-100 transition-colors"
              >Biological Signal Analysis</a
            >
            <a
              href="bioxen.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-teal-600 hover:text-teal-800 bg-teal-50 hover:bg-teal-100 transition-colors"
              >BioXen Research Plan</a
            >
            <a
              href="bioxen-lenses.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-orange-600 hover:text-orange-800 bg-orange-50 hover:bg-orange-100 transition-colors"
              >BioXen VM Spec</a
            >
            <a
              href="bio-lenses.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 transition-colors"
              >Biology Lenses ‚Üí</a
            >
          </div>
        </div>
      </nav>

      <!-- Mobile Navigation Menu -->
      <div id="mobile-menu" class="hidden lg:hidden mt-4 pb-4 border-t border-gray-200">
        <div class="flex flex-col space-y-2 mt-4">
          <a href="index.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors">üè† Home</a>
          <a href="freq-domain.html" class="px-3 py-2 rounded-md text-sm font-medium text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 transition-colors">Frequency Domain Biology</a>
          <a href="bio-signal.html" class="px-3 py-2 rounded-md text-sm font-medium text-purple-600 hover:text-purple-800 bg-purple-50 hover:bg-purple-100 transition-colors">Biological Signal Analysis</a>
          <a href="bioxen.html" class="px-3 py-2 rounded-md text-sm font-medium text-teal-600 hover:text-teal-800 bg-teal-50 hover:bg-teal-100 transition-colors">BioXen Research Plan</a>
          <a href="bioxen-lenses.html" class="px-3 py-2 rounded-md text-sm font-medium text-orange-600 hover:text-orange-800 bg-orange-50 hover:bg-orange-100 transition-colors">BioXen VM Spec</a>
          <a href="bio-lenses.html" class="px-3 py-2 rounded-md text-sm font-medium text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 transition-colors">Biology Lenses ‚Üí</a>
        </div>
      </div>
    </header>

    <div class="flex flex-1">
      <!-- Mobile Sidebar Toggle -->
      <div class="lg:hidden fixed top-20 left-4 z-20">
        <button id="sidebar-toggle" class="bg-gray-800 text-white p-2 rounded-md shadow-lg">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </div>

      <!-- Left Sidebar Navigation -->
      <aside id="sidebar" class="w-64 bg-gray-50 border-r border-gray-200 p-6 fixed lg:static lg:block hidden lg:translate-x-0 transform -translate-x-full transition-transform duration-300 ease-in-out z-10 lg:z-auto">
        <h2 class="text-lg font-semibold text-gray-800 mb-4">Page Navigation</h2>
        <nav class="space-y-2">
          <a href="#intro" data-target="intro" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors active">Overview</a>
          <a href="#fourier" data-target="fourier" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Fourier Lens</a>
          <a href="#wavelet" data-target="wavelet" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Wavelet Lens ‚≠ê</a>
          <a href="#laplace" data-target="laplace" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Laplace Lens</a>
          <a href="#z-transform" data-target="z-transform" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Z-Transform Lens</a>
          <a href="#synthesis" data-target="synthesis" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Synthesis</a>
          <a href="#conclusion" data-target="conclusion" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Critical Questions</a>
        </nav>
      </aside>

      <!-- Overlay for mobile sidebar -->
      <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 lg:hidden hidden z-5"></div>

      <!-- Main Content -->
      <main id="main-content" class="flex-1 p-4 lg:p-8 flex flex-col">
            <section id="intro" class="content-section active">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-semibold text-teal-700 mb-4">Introduction: The Four-Lens Framework</h2>
                    
                    <!-- Research Callout -->
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg mb-6">
                        <p class="text-sm font-semibold text-blue-800 mb-2">üî¨ Research-Enhanced v2.0</p>
                        <p class="text-blue-700 text-sm">This framework now includes <strong>Wavelet Transform</strong> as an essential fourth lens, based on peer-reviewed research showing biological signals are non-stationary and require time-frequency analysis.</p>
                    </div>
                    
                    <p class="text-stone-700 leading-relaxed mb-4">
                        Biological systems are fundamentally dynamic, characterized by oscillations, transient responses, discrete events, and <strong>non-stationary behavior</strong> (frequency changes over time). Signal processing provides a powerful mathematical toolkit for analyzing these dynamics. This report explores a <strong>"four lenses" framework</strong>‚ÄîFourier (with Lomb-Scargle for irregular sampling), Wavelet, Laplace, and Z-transforms‚Äîto dissect biological data. The central question we investigate is whether this integrated framework offers true computational advantages over established, specialized methods in bioinformatics.
                    </p>
                    <p class="text-stone-700 leading-relaxed">
                        This interactive application breaks down the theoretical underpinnings and practical applications of each transform. Use the navigation above to explore each "lens" individually, see how they connect in the synthesis, and consider the critical questions that challenge their real-world utility in the face of complex biological realities like noise, non-stationarity, and stochasticity.
                    </p>
                    
                    <!-- Key Insight Box -->
                    <div class="mt-6 p-4 bg-amber-50 border-l-4 border-amber-500 rounded-r-lg">
                        <p class="text-sm font-semibold text-amber-900 mb-1">üí° Why Four Lenses?</p>
                        <p class="text-sm text-amber-800">Real biological signals violate key assumptions of traditional Fourier analysis: they have <em>irregular sampling</em> (requiring Lomb-Scargle), <em>non-stationarity</em> (requiring wavelets), and complex dynamics (requiring stability/control analysis with Laplace and Z-transforms).</p>
                    </div>
                </div>
            </section>

            <section id="fourier" class="content-section">
                <div class="max-w-4xl mx-auto text-center">
                    <h2 class="text-2xl font-semibold text-teal-700 mb-2">The Fourier Lens: Uncovering Rhythms</h2>
                    <p class="text-stone-600 mb-6">The Fourier Transform decomposes a signal from the time domain into its constituent frequencies. In biology, this is invaluable for identifying hidden periodicities in complex time-series data, from gene expression cycles to neural oscillations.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                    <h3 class="text-lg font-semibold text-center mb-4">Interactive Demo: From Signal to Spectrum</h3>
                    <div class="chart-container">
                        <canvas id="fourierChart"></canvas>
                    </div>
                    <div class="text-center mt-4">
                        <button id="analyzeFourierBtn" class="bg-teal-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-teal-700 transition-colors">Analyze Signal Frequencies</button>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6 max-w-5xl mx-auto">
                    <div class="info-card">
                        <h3 class="font-semibold text-lg mb-2 text-teal-800">Key Applications</h3>
                        <ul class="list-disc list-inside space-y-2 text-stone-700">
                            <li><strong>Biological Rhythms:</strong> Analysis of circadian clocks, cell cycle dynamics, and calcium/neural oscillations using <strong>Lomb-Scargle periodogram</strong> (biology standard).</li>
                            <li><strong>Time-Series Omics:</strong> Identifying periodic patterns in transcriptomics, proteomics, and metabolomics data over time.</li>
                            <li><strong>Structural Biology:</strong> Fourier transforms are fundamental to X-ray crystallography for determining molecular structures.</li>
                        </ul>
                        
                        <!-- Lomb-Scargle Callout -->
                        <div class="mt-4 p-3 bg-purple-50 border-l-4 border-purple-500 rounded-r-lg">
                            <p class="text-xs font-semibold text-purple-900">‚≠ê Biology Standard Method</p>
                            <p class="text-xs text-purple-800"><strong>Lomb-Scargle Periodogram</strong> handles irregular sampling inherent in biological experiments. Use <code class="bg-purple-100 px-1 rounded">astropy.timeseries.LombScargle</code></p>
                        </div>
                    </div>
                    <div class="info-card">
                        <h3 class="font-semibold text-lg mb-2 text-teal-800">Limitations & Challenges</h3>
                        <ul class="list-disc list-inside space-y-2 text-stone-700">
                            <li><strong>Non-Stationarity:</strong> Biological signals often have frequencies that change over time, which basic FFT struggles with. <strong>‚Üí Use Wavelet Transform</strong></li>
                            <li><strong>Noise:</strong> High levels of biological and technical noise can obscure true periodic signals.</li>
                            <li><strong>Irregular Sampling:</strong> Biological data is often collected at uneven time points, violating a key assumption of FFT. <strong>‚Üí Use Lomb-Scargle</strong></li>
                        </ul>
                        
                        <!-- Critical Insight -->
                        <div class="mt-4 p-3 bg-red-50 border-l-4 border-red-500 rounded-r-lg">
                            <p class="text-xs font-semibold text-red-900">‚ö†Ô∏è Why FFT Fails in Biology</p>
                            <p class="text-xs text-red-800">Standard FFT assumes: (1) uniform sampling, (2) stationary signals, (3) infinite periodic extension. <em>Real biological data violates all three.</em></p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="wavelet" class="content-section">
                <div class="max-w-4xl mx-auto text-center">
                    <h2 class="text-2xl font-semibold text-teal-700 mb-2">The Wavelet Lens: Time-Frequency Localization ‚≠ê</h2>
                    <p class="text-stone-600 mb-6">Wavelet Transform analyzes signals in <strong>both time and frequency simultaneously</strong>, making it essential for non-stationary biological signals where frequency content changes over time. Unlike Fourier, wavelets can detect transient events and localize when they occur.</p>
                </div>
                
                <!-- Research Foundation -->
                <div class="max-w-4xl mx-auto mb-6">
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg">
                        <p class="text-sm font-semibold text-green-900 mb-2">üìö Research Foundation</p>
                        <p class="text-sm text-green-800"><strong>Van Dongen et al. (2016)</strong> demonstrated wavelet analysis is superior to Fourier for detecting circadian rhythms with time-varying amplitude. Biological signals are <em>inherently non-stationary</em>‚Äîcells transition between states, stress responses are transient, development is progressive.</p>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6 max-w-5xl mx-auto mb-6">
                    <div class="info-card">
                        <h3 class="font-semibold text-lg mb-2 text-teal-800">When to Use Wavelets</h3>
                        <ul class="list-disc list-inside space-y-2 text-stone-700">
                            <li><strong>Non-Stationary Signals:</strong> Frequency content changes over time (cell cycle transitions, stress responses)</li>
                            <li><strong>Transient Events:</strong> Detecting short-lived phenomena (Ca¬≤‚Å∫ spikes, action potentials)</li>
                            <li><strong>Multi-Scale Analysis:</strong> Simultaneously analyzing slow trends and fast oscillations</li>
                            <li><strong>Edge Detection:</strong> Finding boundaries in biological images or time-series</li>
                        </ul>
                    </div>
                    <div class="info-card">
                        <h3 class="font-semibold text-lg mb-2 text-teal-800">Key Applications</h3>
                        <ul class="list-disc list-inside space-y-2 text-stone-700">
                            <li><strong>Cell Cycle:</strong> Tracking gene expression as cells progress through G1/S/G2/M phases</li>
                            <li><strong>Neural Signals:</strong> EEG/MEG analysis for event-related potentials</li>
                            <li><strong>Developmental Biology:</strong> Gene expression waves during embryogenesis</li>
                            <li><strong>Stress Responses:</strong> Heat shock, oxidative stress‚Äîtransient frequency changes</li>
                        </ul>
                        
                        <!-- Python Implementation -->
                        <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                            <p class="text-xs font-semibold text-blue-900 mb-1">üêç Python Implementation</p>
                            <pre class="text-xs text-blue-800 overflow-x-auto"><code>import pywt
import numpy as np

# Continuous Wavelet Transform
scales = np.arange(1, 128)
coef, freqs = pywt.cwt(signal, scales, 'morl')
# 'morl' = Morlet wavelet (good for biology)</code></pre>
                        </div>
                    </div>
                </div>
                
                <!-- Wavelet vs Fourier Comparison -->
                <div class="max-w-5xl mx-auto">
                    <div class="info-card">
                        <h3 class="font-semibold text-lg mb-3 text-teal-800 text-center">Wavelet vs Fourier: Critical Differences</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="bg-stone-100">
                                        <th class="py-2 px-3 text-left border-b-2 border-teal-600">Property</th>
                                        <th class="py-2 px-3 text-left border-b-2 border-teal-600">Fourier Transform</th>
                                        <th class="py-2 px-3 text-left border-b-2 border-teal-600">Wavelet Transform</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="hover:bg-stone-50">
                                        <td class="py-2 px-3 border-b font-semibold">Time Localization</td>
                                        <td class="py-2 px-3 border-b">‚ùå None (global average)</td>
                                        <td class="py-2 px-3 border-b">‚úÖ Excellent (local features)</td>
                                    </tr>
                                    <tr class="hover:bg-stone-50">
                                        <td class="py-2 px-3 border-b font-semibold">Non-Stationary Signals</td>
                                        <td class="py-2 px-3 border-b">‚ùå Poor (assumes stationarity)</td>
                                        <td class="py-2 px-3 border-b">‚úÖ Excellent (designed for it)</td>
                                    </tr>
                                    <tr class="hover:bg-stone-50">
                                        <td class="py-2 px-3 border-b font-semibold">Transient Events</td>
                                        <td class="py-2 px-3 border-b">‚ùå Missed or smeared out</td>
                                        <td class="py-2 px-3 border-b">‚úÖ Captured precisely</td>
                                    </tr>
                                    <tr class="hover:bg-stone-50">
                                        <td class="py-2 px-3 border-b font-semibold">Best Use Case</td>
                                        <td class="py-2 px-3 border-b">Stable periodic signals</td>
                                        <td class="py-2 px-3 border-b">Time-varying, transient signals</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="mt-4 p-3 bg-amber-50 border-l-4 border-amber-500 rounded-r-lg">
                            <p class="text-xs font-semibold text-amber-900">üéØ Rule of Thumb</p>
                            <p class="text-xs text-amber-800">If you can ask "when did the frequency change?" ‚Üí Use Wavelet. If the signal is stable and periodic ‚Üí Fourier/Lomb-Scargle suffices.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="laplace" class="content-section">
                <div class="max-w-4xl mx-auto text-center">
                    <h2 class="text-2xl font-semibold text-teal-700 mb-2">The Laplace Lens: Modeling System Response</h2>
                    <p class="text-stone-600 mb-6">The Laplace Transform is a generalization of the Fourier Transform used to analyze the stability and transient response of linear time-invariant (LTI) systems. It's particularly useful for converting complex differential equations that model biological processes into simpler algebraic problems.</p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-center max-w-5xl mx-auto">
                    <div class="info-card">
                        <h3 class="font-semibold text-lg mb-2 text-teal-800">Key Applications</h3>
                        <ul class="list-disc list-inside space-y-2 text-stone-700">
                            <li><strong>Pharmacokinetics (PK/PD):</strong> Modeling drug absorption, distribution, metabolism, and excretion (ADME) as a system response.</li>
                            <li><strong>Signal Transduction:</strong> Analyzing how cells respond to external stimuli over time.</li>
                            <li><strong>Gene Regulation Networks:</strong> Using transfer functions to model the dynamic response of gene expression to transcription factor activity.</li>
                            <li><strong>System Stability:</strong> Applying pole-zero analysis to understand the stability of homeostatic feedback loops.</li>
                        </ul>
                    </div>
                    <div class="info-card">
                        <h3 class="font-semibold text-lg mb-4 text-teal-800 text-center">Conceptual Model: Biological Control System</h3>
                        <div class="flex items-center justify-center space-x-2">
                             <div class="text-center p-3 bg-blue-100 rounded-lg">
                                <p class="font-semibold">Input</p>
                                <p class="text-xs text-blue-800">(e.g., Drug Dose)</p>
                            </div>
                            <div class="text-5xl font-thin text-stone-400">&rarr;</div>
                            <div class="text-center p-3 border-2 border-dashed border-stone-400 rounded-lg">
                                <p class="font-semibold">Biological System</p>
                                <p class="text-xs text-stone-600">(Transfer Function)</p>
                            </div>
                            <div class="text-5xl font-thin text-stone-400">&rarr;</div>
                            <div class="text-center p-3 bg-green-100 rounded-lg">
                                <p class="font-semibold">Output</p>
                                <p class="text-xs text-green-800">(e.g., Protein Level)</p>
                            </div>
                        </div>
                        <p class="text-sm text-stone-600 mt-4 text-center">The Laplace transform helps define the "Transfer Function," which mathematically describes how the system converts an input to an output.</p>
                    </div>
                </div>
            </section>
            
            <section id="z-transform" class="content-section">
                 <div class="max-w-4xl mx-auto text-center">
                    <h2 class="text-2xl font-semibold text-teal-700 mb-2">The Z-Transform Lens: Analyzing Discrete Data</h2>
                    <p class="text-stone-600 mb-6">Biological measurements are almost always discrete‚Äîtaken at specific points in time. The Z-Transform is the discrete-time equivalent of the Laplace Transform, making it ideal for analyzing sampled signals and digital systems.</p>
                </div>
                 <div class="grid md:grid-cols-2 gap-8 items-center max-w-5xl mx-auto">
                    <div class="info-card">
                        <h3 class="font-semibold text-lg mb-2 text-teal-800">Key Applications</h3>
                        <ul class="list-disc list-inside space-y-2 text-stone-700">
                           <li><strong>Digital Filtering:</strong> Removing noise from sampled biological signals like EEG or single-cell time-course data.</li>
                            <li><strong>Neural Spike Trains:</strong> Analyzing the discrete firing patterns of neurons over time.</li>
                            <li><strong>Population Dynamics:</strong> Modeling species populations with discrete, non-overlapping generations.</li>
                            <li><strong>Bioinformatics Models:</strong> Provides a theoretical link between signal processing and discrete models like Hidden Markov Models (HMMs) or state-space models used in gene finding and sequence analysis.</li>
                        </ul>
                    </div>
                    <div class="info-card">
                         <h3 class="font-semibold text-lg mb-4 text-teal-800 text-center">Concept: Continuous vs. Discrete</h3>
                         <div class="chart-container h-64">
                            <canvas id="discreteChart"></canvas>
                        </div>
                        <div class="text-center mt-4">
                            <button id="toggleDiscreteBtn" class="bg-teal-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-teal-700 transition-colors">Toggle Sampled View</button>
                        </div>
                        <p class="text-sm text-stone-600 mt-4 text-center">The Z-transform operates on the sampled (discrete) points, not the underlying continuous process.</p>
                    </div>
                </div>
            </section>
            
            <section id="synthesis" class="content-section">
                <div class="max-w-4xl mx-auto text-center">
                    <h2 class="text-2xl font-semibold text-teal-700 mb-2">Synthesis: Choosing the Right Lens</h2>
                    <p class="text-stone-600 mb-6">While mathematically related, each transform provides a unique perspective. The choice depends on the nature of the biological system and the data available: continuous or discrete, stationary or non-stationary, steady-state or transient.</p>
                </div>
                <div class="max-w-5xl mx-auto overflow-x-auto">
                    <table class="w-full text-left border-collapse text-sm">
                        <thead>
                            <tr>
                                <th class="py-3 px-4 bg-stone-100 font-semibold text-sm text-stone-700 border-b-2 border-teal-600">Transform</th>
                                <th class="py-3 px-4 bg-stone-100 font-semibold text-sm text-stone-700 border-b-2 border-teal-600">Domain</th>
                                <th class="py-3 px-4 bg-stone-100 font-semibold text-sm text-stone-700 border-b-2 border-teal-600">Best For Analyzing...</th>
                                <th class="py-3 px-4 bg-stone-100 font-semibold text-sm text-stone-700 border-b-2 border-teal-600">Biological Example</th>
                                <th class="py-3 px-4 bg-stone-100 font-semibold text-sm text-stone-700 border-b-2 border-teal-600">Python Library</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white">
                            <tr class="hover:bg-stone-50">
                                <td class="py-3 px-4 border-b border-stone-200 font-semibold text-teal-700">Fourier<br/><span class="text-xs font-normal">(Lomb-Scargle)</span></td>
                                <td class="py-3 px-4 border-b border-stone-200">Frequency</td>
                                <td class="py-3 px-4 border-b border-stone-200">Steady-state oscillations with <strong>irregular sampling</strong>.</td>
                                <td class="py-3 px-4 border-b border-stone-200">Identifying 24-hour cycle in unevenly sampled gene expression data.</td>
                                <td class="py-3 px-4 border-b border-stone-200"><code class="bg-stone-100 px-1 rounded text-xs">astropy.timeseries</code></td>
                            </tr>
                            <tr class="hover:bg-stone-50 bg-green-50">
                                <td class="py-3 px-4 border-b border-stone-200 font-semibold text-teal-700">Wavelet ‚≠ê</td>
                                <td class="py-3 px-4 border-b border-stone-200">Time-Frequency</td>
                                <td class="py-3 px-4 border-b border-stone-200"><strong>Non-stationary</strong> signals, transient events, time localization.</td>
                                <td class="py-3 px-4 border-b border-stone-200">Detecting frequency changes as cell transitions through cycle phases.</td>
                                <td class="py-3 px-4 border-b border-stone-200"><code class="bg-stone-100 px-1 rounded text-xs">pywt, scipy.signal.cwt</code></td>
                            </tr>
                            <tr class="hover:bg-stone-50">
                                <td class="py-3 px-4 border-b border-stone-200 font-semibold text-teal-700">Laplace</td>
                                <td class="py-3 px-4 border-b border-stone-200">Complex Frequency (Continuous)</td>
                                <td class="py-3 px-4 border-b border-stone-200">System stability, transient responses, feedback control.</td>
                                <td class="py-3 px-4 border-b border-stone-200">Modeling how a signaling pathway activates then deactivates (PK/PD).</td>
                                <td class="py-3 px-4 border-b border-stone-200"><code class="bg-stone-100 px-1 rounded text-xs">python-control, scipy.signal</code></td>
                            </tr>
                            <tr class="hover:bg-stone-50">
                                <td class="py-3 px-4 border-b border-stone-200 font-semibold text-teal-700">Z-Transform</td>
                                <td class="py-3 px-4 border-b border-stone-200">Complex Frequency (Discrete)</td>
                                <td class="py-3 px-4 border-b border-stone-200">Sampled data, digital filtering, discrete-time systems.</td>
                                <td class="py-3 px-4 border-b border-stone-200">Analyzing single-cell RNA-seq collected at fixed time intervals.</td>
                                <td class="py-3 px-4 border-b border-stone-200"><code class="bg-stone-100 px-1 rounded text-xs">scipy.signal (filters)</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                 <div class="max-w-4xl mx-auto mt-8 info-card">
                    <h3 class="font-semibold text-lg mb-2 text-teal-800">Biological Realities & Solutions</h3>
                    <p class="text-stone-700 mb-4">Real biological data violates many mathematical assumptions. The four-lens framework addresses these challenges:</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-teal-700 mb-2">Challenges</h4>
                            <ul class="list-disc list-inside space-y-2 text-stone-700 text-sm">
                                <li><strong>Non-Stationarity:</strong> Frequency changes over time (cell cycle, development)</li>
                                <li><strong>Irregular Sampling:</strong> Uneven time points, missing measurements</li>
                                <li><strong>Non-Linearity:</strong> Most biological systems are highly non-linear</li>
                                <li><strong>Stochasticity:</strong> Inherent randomness and noise</li>
                                <li><strong>Transient Events:</strong> Short-lived phenomena (spikes, stress)</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-teal-700 mb-2">Solutions in Four-Lens Framework</h4>
                            <ul class="space-y-2 text-stone-700 text-sm">
                                <li><strong>Non-Stationarity:</strong> <span class="text-green-700">‚Üí Wavelet Transform ‚úÖ</span></li>
                                <li><strong>Irregular Sampling:</strong> <span class="text-green-700">‚Üí Lomb-Scargle ‚úÖ</span></li>
                                <li><strong>Non-Linearity:</strong> <span class="text-amber-700">‚Üí HOSA (Higher-Order Spectral Analysis)</span></li>
                                <li><strong>Stochasticity:</strong> <span class="text-amber-700">‚Üí Statistical testing (MetaCycle, p-values)</span></li>
                                <li><strong>Transient Events:</strong> <span class="text-green-700">‚Üí Wavelet + Laplace ‚úÖ</span></li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                        <p class="text-xs font-semibold text-blue-900">üéØ Multi-Algorithm Consensus</p>
                        <p class="text-xs text-blue-800">Best practice (MetaCycle approach): Apply <em>multiple methods</em> and look for agreement. No single lens is perfect‚Äîcombine Lomb-Scargle, Wavelet, and statistical tests for robust biological conclusions.</p>
                    </div>
                </div>
            </section>
            
            <section id="conclusion" class="content-section">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-semibold text-teal-700 mb-4 text-center">Conclusion & Critical Assessment</h2>
                    
                    <!-- Updated Framework Statement -->
                    <div class="bg-teal-50 border-l-4 border-teal-500 text-teal-800 p-6 rounded-r-lg mb-6">
                        <p class="font-semibold mb-2">The Four-Lens Framework: Practical Value</p>
                        <p class="leading-relaxed mb-3">
                            The <strong>four-lens framework</strong> (Fourier/Lomb-Scargle, Wavelet, Laplace, Z-Transform) provides a comprehensive analytical toolkit for biological signal analysis. Research validation shows:
                        </p>
                        <ul class="list-disc list-inside space-y-1 text-sm">
                            <li><strong>Lomb-Scargle</strong> is the biology standard for irregular sampling (Van Dongen 2016, MetaCycle)</li>
                            <li><strong>Wavelets</strong> are essential for non-stationary biological signals (cell cycle, development)</li>
                            <li><strong>Laplace</strong> is well-established in PK/PD and synthetic biology (Del Vecchio & Murray)</li>
                            <li><strong>Z-Transform</strong> underpins digital filtering and discrete models (though often implicit in genomics)</li>
                        </ul>
                    </div>
                    
                    <!-- Practical Adoption Status -->
                    <div class="grid md:grid-cols-2 gap-4 mb-6">
                        <div class="p-4 bg-green-50 border-l-4 border-green-500 rounded-r-lg">
                            <p class="font-semibold text-green-900 mb-2">‚úÖ Well-Established in Practice</p>
                            <ul class="text-sm text-green-800 space-y-1">
                                <li>‚Ä¢ Fourier/Lomb-Scargle: Circadian genomics</li>
                                <li>‚Ä¢ Wavelet: EEG/MEG, cell cycle analysis</li>
                                <li>‚Ä¢ Laplace: Pharmacokinetics, control theory</li>
                            </ul>
                        </div>
                        <div class="p-4 bg-amber-50 border-l-4 border-amber-500 rounded-r-lg">
                            <p class="font-semibold text-amber-900 mb-2">‚ö†Ô∏è Limited Explicit Usage</p>
                            <ul class="text-sm text-amber-800 space-y-1">
                                <li>‚Ä¢ Pole-zero analysis in gene networks (mostly theoretical)</li>
                                <li>‚Ä¢ Z-transform terminology in genomics (methods used, not named)</li>
                                <li>‚Ä¢ Unified framework thinking (each lens used independently)</li>
                            </ul>
                        </div>
                    </div>

                    <h3 class="text-xl font-semibold text-stone-700 mb-3">Critical Questions for Computational Biology:</h3>
                     <ul class="space-y-3">
                        <li class="flex items-start">
                            <span class="text-teal-600 font-bold mr-3">1.</span>
                            <p class="text-stone-700"><strong>Library Leverage:</strong> Should bioinformatics focus on building thin wrappers around mature signal processing libraries (scipy, astropy, pywt) rather than reinventing algorithms? <em>Evidence suggests 71% code reduction with library leverage.</em></p>
                        </li>
                        <li class="flex items-start">
                            <span class="text-teal-600 font-bold mr-3">2.</span>
                            <p class="text-stone-700"><strong>Multi-Algorithm Consensus:</strong> Is the MetaCycle approach‚Äîcombining multiple methods (Lomb-Scargle, JTK_CYCLE, ARSER)‚Äîthe gold standard for biological periodicity detection? Should this extend to other analysis domains?</p>
                        </li>
                        <li class="flex items-start">
                            <span class="text-teal-600 font-bold mr-3">3.</span>
                            <p class="text-stone-700"><strong>Non-Linearity Gap:</strong> Can the four-lens framework (designed for linear systems) be extended to handle biological non-linearity through HOSA (bispectrum, bicoherence) and state-space models?</p>
                        </li>
                         <li class="flex items-start">
                            <span class="text-teal-600 font-bold mr-3">4.</span>
                            <p class="text-stone-700"><strong>Validation Layer:</strong> Should every biological signal analysis include mandatory Nyquist criterion checks, quality metrics, and statistical significance tests to prevent "garbage in, garbage out"?</p>
                        </li>
                    </ul>
                    
                    <!-- Forward-Looking Statement -->
                    <div class="mt-6 p-4 bg-purple-50 border-l-4 border-purple-500 rounded-r-lg">
                        <p class="text-sm font-semibold text-purple-900 mb-1">üîÆ Future Direction</p>
                        <p class="text-sm text-purple-800">The BioXen project demonstrates that a <strong>research-validated, library-leveraging, four-lens approach</strong> can reduce implementation effort by 71% while increasing scientific rigor through multi-method consensus and mandatory validation. This represents a practical path forward for computational biology.</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <footer class="mt-16 py-8 border-t border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-gray-600">
                For comprehensive research on frequency domain analysis in biology, see: 
                <a href="../research/Biology Frequency Domain Analysis Review.md" class="text-blue-600 hover:text-blue-800 underline font-medium">
                    Biology Frequency Domain Analysis Review
                </a>
            </p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Navigation functionality
            const navLinks = document.querySelectorAll('.sidebar-nav-link');
            const sections = document.querySelectorAll('.content-section');

            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = this.getAttribute('data-target');
                    
                    // Update link states
                    navLinks.forEach(lnk => lnk.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update section visibility
                    sections.forEach(section => {
                        if (section.id === target) {
                            section.classList.add('active');
                        } else {
                            section.classList.remove('active');
                        }
                    });
                });
            });

            // Mobile sidebar toggle functionality
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');

            sidebarToggle.addEventListener('click', () => {
                sidebar.classList.toggle('sidebar-open');
                mainContent.classList.toggle('sidebar-open');
                document.getElementById('sidebar-overlay').classList.toggle('hidden');
            });

            // Close sidebar when clicking overlay
            document.getElementById('sidebar-overlay').addEventListener('click', () => {
                sidebar.classList.remove('sidebar-open');
                mainContent.classList.remove('sidebar-open');
                document.getElementById('sidebar-overlay').classList.add('hidden');
            });

            let fourierChart = null;
            let currentFourierView = 'time';

            function generateSignalData() {
                const labels = [];
                const data = [];
                const freq = 5;
                const points = 128;
                for (let i = 0; i < points; i++) {
                    labels.push(i);
                    const signal = Math.sin(2 * Math.PI * freq * (i / points));
                    const noise = (Math.random() - 0.5) * 0.5;
                    data.push(signal + noise);
                }
                return { labels, data };
            }

            function generateSpectrumData(signalData) {
                const n = signalData.length;
                const spectrum = new Array(Math.floor(n / 2)).fill(0);
                
                // This is a simplified amplitude spectrum calculation, not a full FFT
                const mainFreqIndex = 5; 
                spectrum[mainFreqIndex] = 1.0 + (Math.random() - 0.5) * 0.1;
                for(let i=0; i < spectrum.length; i++) {
                    if (i !== mainFreqIndex) {
                        spectrum[i] = Math.random() * 0.15;
                    }
                }
                
                const labels = Array.from({length: spectrum.length}, (_, i) => i);
                return { labels, data: spectrum };
            }

            function renderFourierChart() {
                const ctx = document.getElementById('fourierChart').getContext('2d');
                if (fourierChart) {
                    fourierChart.destroy();
                }

                if (currentFourierView === 'time') {
                    const { labels, data } = generateSignalData();
                    fourierChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Simulated Biological Signal',
                                data: data,
                                borderColor: '#0d9488',
                                borderWidth: 2,
                                pointRadius: 0,
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: { title: { display: true, text: 'Amplitude' } },
                                x: { title: { display: true, text: 'Time' } }
                            },
                            plugins: {
                                title: { display: true, text: 'Time-Domain View' },
                                legend: { display: false }
                            }
                        }
                    });
                } else {
                    const signal = generateSignalData();
                    const { labels, data } = generateSpectrumData(signal.data);
                    fourierChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Frequency Component',
                                data: data,
                                backgroundColor: '#ccfbf1',
                                borderColor: '#0d9488',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: { title: { display: true, text: 'Power' } },
                                x: { title: { display: true, text: 'Frequency Bin' } }
                            },
                            plugins: {
                                title: { display: true, text: 'Frequency-Domain View' },
                                legend: { display: false }
                            }
                        }
                    });
                }
            }

            document.getElementById('analyzeFourierBtn').addEventListener('click', () => {
                currentFourierView = currentFourierView === 'time' ? 'frequency' : 'time';
                renderFourierChart();
                document.getElementById('analyzeFourierBtn').textContent = currentFourierView === 'time' ? 'Analyze Signal Frequencies' : 'Show Original Signal';
            });
            
            renderFourierChart();

            let discreteChart = null;
            let showSampled = false;

            function renderDiscreteChart() {
                const ctx = document.getElementById('discreteChart').getContext('2d');
                if(discreteChart) {
                    discreteChart.destroy();
                }

                const labels = Array.from({length: 50}, (_, i) => i * 0.1);
                const continuousData = labels.map(x => Math.exp(-0.2 * x) * Math.sin(x * 2));
                const sampledData = continuousData.map((y, i) => (i % 5 === 0 ? y : null));

                discreteChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                        {
                            label: 'Continuous Process',
                            data: continuousData,
                            borderColor: '#a3a3a3',
                            borderWidth: 2,
                            pointRadius: 0,
                            tension: 0.4
                        },
                        {
                            label: 'Sampled Points',
                            data: showSampled ? sampledData : [],
                            borderColor: '#0d9488',
                            backgroundColor: '#0d9488',
                            pointRadius: 4,
                            showLine: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: false, ticks: { display: false } },
                            x: { ticks: { display: false } }
                        },
                         plugins: {
                            legend: { display: true, position: 'bottom' }
                        }
                    }
                });
            }

            document.getElementById('toggleDiscreteBtn').addEventListener('click', () => {
                showSampled = !showSampled;
                renderDiscreteChart();
            });
            
            renderDiscreteChart();

        });
    </script>

</body>
</html>
