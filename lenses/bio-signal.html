<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frequency Domain Analysis in Biology: A Method Selection Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: The application is structured as an interactive "Method Selection Guide" rather than a linear report. This design prioritizes user task-flow and comprehension over mimicking the source document's layout. The structure includes: 1) A top navigation for quick access to key themes (Core Concepts, Challenges, Method Explorer, Implementation). 2) A "Core Concepts" section to clarify the Z-Transform's role. 3) An interactive "Challenges" section using a card layout to break down complex limitations. 4) The central "Method Explorer," which allows users to select a biological signal type and receive a tailored recommendation and visualization. This interactive, problem-solution format is chosen to make the dense, technical information more digestible and actionable for researchers and students. -->
    <!-- Visualization & Content Choices: 
        - Z-Transform vs. Discrete Models: (Goal: Inform) A side-by-side text comparison is used for clarity. Interaction: A toggle could show/hide the mathematical formalism. Justification: Avoids a complex diagram for a conceptual point. Method: HTML/JS.
        - Challenges Section: (Goal: Organize) A grid of cards. Interaction: Hover effects provide visual feedback. Justification: Breaks down four major limitations into scannable, parallel concepts. Method: HTML/Tailwind.
        - Method Explorer: (Goal: Compare/Guide) A dropdown menu allows users to select a signal type. Interaction: The selection dynamically updates a recommendation text block and a Chart.js visualization. Justification: This is the core interactive element, directly answering the user's question of "which tool to use when," making it highly effective. Library: Chart.js (Canvas).
        - Implementation Section: (Goal: Inform/Compare) Cards for software tools and a simple bar chart for computational cost. Justification: Presents practical information in an easily scannable format. Library: Chart.js (Canvas).
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

</head>
<body class="antialiased flex flex-col min-h-screen">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-10 shadow-sm border-b border-gray-200">
      <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center">
            <h1 class="text-xl font-bold text-purple-700">BioSignal Analysis Guide</h1>
          </div>
          <div class="hidden md:flex items-center space-x-4">
            <a
              href="index.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors"
              >üè† Home</a
            >
            <a
              href="freq-domain.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 transition-colors"
              >Frequency Domain Biology</a
            >
            <a
              href="bio-signal.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-purple-600 hover:text-purple-800 bg-purple-50 hover:bg-purple-100 transition-colors"
              >Biological Signal Analysis</a
            >
            <a
              href="bioxen.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-teal-600 hover:text-teal-800 bg-teal-50 hover:bg-teal-100 transition-colors"
              >BioXen Research Plan</a
            >
            <a
              href="bioxen-lenses.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-orange-600 hover:text-orange-800 bg-orange-50 hover:bg-orange-100 transition-colors"
              >BioXen VM Spec</a
            >
            <a
              href="wavelets.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-amber-600 hover:text-amber-800 bg-amber-50 hover:bg-amber-100 transition-colors"
              >Wavelet Analysis</a
            >
            <a
              href="bio-lenses.html"
              class="px-3 py-2 rounded-md text-sm font-medium text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 transition-colors"
              >Biology Lenses ‚Üí</a
            >
          </div>
        </div>
      </nav>

      <!-- Mobile Navigation Menu -->
      <div id="mobile-menu" class="hidden lg:hidden mt-4 pb-4 border-t border-gray-200">
        <div class="flex flex-col space-y-2 mt-4">
          <a href="index.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:text-gray-800 bg-gray-50 hover:bg-gray-100 transition-colors">üè† Home</a>
          <a href="freq-domain.html" class="px-3 py-2 rounded-md text-sm font-medium text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 transition-colors">Frequency Domain Biology</a>
          <a href="bio-signal.html" class="px-3 py-2 rounded-md text-sm font-medium text-purple-600 hover:text-purple-800 bg-purple-50 hover:bg-purple-100 transition-colors">Biological Signal Analysis</a>
          <a href="bioxen.html" class="px-3 py-2 rounded-md text-sm font-medium text-teal-600 hover:text-teal-800 bg-teal-50 hover:bg-teal-100 transition-colors">BioXen Research Plan</a>
          <a href="bioxen-lenses.html" class="px-3 py-2 rounded-md text-sm font-medium text-orange-600 hover:text-orange-800 bg-orange-50 hover:bg-orange-100 transition-colors">BioXen VM Spec</a>
          <a href="wavelets.html" class="px-3 py-2 rounded-md text-sm font-medium text-amber-600 hover:text-amber-800 bg-amber-50 hover:bg-amber-100 transition-colors">Wavelet Analysis</a>
          <a href="bio-lenses.html" class="px-3 py-2 rounded-md text-sm font-medium text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 transition-colors">Biology Lenses ‚Üí</a>
        </div>
      </div>
    </header>

    <div class="flex flex-1">
      <!-- Mobile Sidebar Toggle -->
      <div class="lg:hidden fixed top-20 left-4 z-20">
        <button id="sidebar-toggle" class="bg-gray-800 text-white p-2 rounded-md shadow-lg">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </div>

      <!-- Left Sidebar Navigation -->
      <aside id="sidebar" class="w-64 bg-gray-50 border-r border-gray-200 p-6 fixed lg:static lg:block hidden lg:translate-x-0 transform -translate-x-full transition-transform duration-300 ease-in-out z-10 lg:z-auto">
        <h2 class="text-lg font-semibold text-gray-800 mb-4">Page Navigation</h2>
        <nav class="space-y-2">
          <a href="#hero" data-target="hero" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors active">Introduction</a>
          <a href="#concepts" data-target="concepts" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Core Concepts</a>
          <a href="#challenges" data-target="challenges" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Challenges</a>
          <a href="#explorer" data-target="explorer" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Method Explorer</a>
          <a href="#implementation" data-target="implementation" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Implementation</a>
          <a href="#conclusion" data-target="conclusion" class="sidebar-nav-link block px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 transition-colors">Conclusion</a>
        </nav>
      </aside>

      <!-- Overlay for mobile sidebar -->
      <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 lg:hidden hidden z-5"></div>

      <!-- Main Content -->
      <main id="main-content" class="flex-1 p-4 lg:p-8 flex flex-col">

        <section id="hero" class="content-section active">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-bold mb-4 leading-tight">Choosing the Right Tool for Biological Signal Analysis</h2>
                <p class="text-lg text-gray-600">An interactive guide to understanding Z-Transforms, their limitations, and modern alternatives for analyzing complex biological data.</p>
            </div>
            
            <div class="max-w-4xl mx-auto">
                <div class="bg-gradient-to-r from-cyan-50 to-blue-50 border-l-4 border-cyan-500 p-6 rounded-r-lg mb-8">
                    <h3 class="font-semibold text-cyan-900 mb-3 flex items-center">
                        üî¨ Research-Enhanced Guide
                        <span class="ml-2 text-xs bg-cyan-600 text-white px-2 py-1 rounded">v2.0</span>
                    </h3>
                    <p class="text-sm text-cyan-800 leading-relaxed mb-3">
                        This guide has been updated based on comprehensive peer-reviewed research into biological signal analysis. 
                        Key findings include:
                    </p>
                    <ul class="text-sm text-cyan-800 space-y-1 ml-4">
                        <li>‚Ä¢ <strong>Wavelet Transform is essential</strong> for non-stationary biological signals (not just "alternative")</li>
                        <li>‚Ä¢ <strong>Lomb-Scargle Periodogram</strong> is the biology standard for irregular sampling (not FFT)</li>
                        <li>‚Ä¢ <strong>Higher-Order Spectral Analysis (HOSA)</strong> needed for nonlinear biological systems</li>
                        <li>‚Ä¢ <strong>State-Space Models</strong> superior to transfer functions for MIMO biological networks</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="concepts" class="content-section">
            <h3 class="text-3xl font-bold text-center mb-2">Core Concepts</h3>
            <p class="text-center text-gray-500 mb-12">The Z-Transform in the Context of Discrete Biological Systems</p>
            <div class="grid md:grid-cols-2 gap-8 items-center">
                <div class="card">
                    <h4 class="text-xl font-semibold mb-3 text-blue-600">Discrete-Time Models: The Foundation</h4>
                    <p class="text-gray-700">Many biological processes are modeled in discrete time steps (e.g., cell division cycles, daily rhythms). These models describe system behavior from one sample to the next. For instance, a simple population growth model might be expressed as:</p>
                    <div class="mt-4 p-3 bg-gray-50 rounded-lg text-sm font-mono">
                        N[k+1] = (1 + r) * N[k]
                    </div>
                    <p class="mt-3 text-gray-700">This is fundamentally a digital representation of a biological system, making it suitable for digital signal processing (DSP) techniques.</p>
                </div>
                <div class="card">
                    <h4 class="text-xl font-semibold mb-3 text-blue-600">Z-Transform: The Formalism</h4>
                    <p class="text-gray-700">The Z-Transform is the mathematical tool that converts these discrete-time difference equations into an algebraic frequency-domain representation (the Z-domain). This allows engineers to analyze system properties like stability, frequency response, and design digital filters.</p>
                    <div class="mt-4 p-3 bg-gray-50 rounded-lg text-sm font-mono">
                         z N(z) = (1 + r) * N(z)
                    </div>
                    <p class="mt-3 text-gray-700 font-semibold">Honest Assessment:</p>
                    <p class="mt-1 text-gray-700">While countless biological systems are modeled discretely, the formal Z-Transform is rarely mentioned explicitly in biological literature outside of bio-control systems or pure DSP applications for sensor data. The principles are used implicitly, but the formalism itself is not a common language for most biologists.</p>
                </div>
            </div>
        </section>

        <section id="challenges" class="content-section">
            <h3 class="text-3xl font-bold text-center mb-2">The Biological Reality</h3>
            <p class="text-center text-gray-500 mb-12">Why Linear Transform Methods Often Fall Short</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="card">
                    <h4 class="font-semibold text-lg mb-2">Non-Linearity</h4>
                    <p class="text-sm text-gray-600">Biological systems are rarely linear. Processes like enzyme kinetics (Michaelis-Menten) and gene regulation (Hill functions) exhibit saturation. Transforms assume linearity, so they are often only valid for small perturbations around a specific operating point.</p>
                    <div class="mt-3 p-2 bg-orange-50 border-l-2 border-orange-400 rounded">
                        <p class="text-xs text-orange-900"><strong>Solution:</strong> Use Higher-Order Spectral Analysis (HOSA) like Bispectrum/Bicoherence to detect nonlinear interactions</p>
                    </div>
                </div>
                <div class="card">
                    <h4 class="font-semibold text-lg mb-2">Stochasticity</h4>
                    <p class="text-sm text-gray-600">Molecular noise is significant, especially at low copy numbers of proteins or mRNA. Transform methods are deterministic and can fail to capture the random fluctuations that are often biologically important. Analysis often requires averaging over many cells or trials.</p>
                    <div class="mt-3 p-2 bg-blue-50 border-l-2 border-blue-400 rounded">
                        <p class="text-xs text-blue-900"><strong>Solution:</strong> Use stochastic differential equations (SDEs) or ensemble averaging with statistical significance testing</p>
                    </div>
                </div>
                <div class="card">
                    <h4 class="font-semibold text-lg mb-2">Non-Stationarity ‚≠ê</h4>
                    <p class="text-sm text-gray-600">The properties of biological systems change over time. Cells age, differentiate, or adapt to new environments. This means the underlying "rules" of the system are not constant, violating a key assumption of standard Fourier and Z-Transforms.</p>
                    <div class="mt-3 p-2 bg-cyan-50 border-l-2 border-cyan-400 rounded">
                        <p class="text-xs text-cyan-900"><strong>Solution:</strong> Use <strong>Wavelet Transform</strong> for time-frequency localization - this is ESSENTIAL, not optional!</p>
                    </div>
                </div>
                <div class="card">
                    <h4 class="font-semibold text-lg mb-2">Irregular Sampling ‚≠ê</h4>
                    <p class="text-sm text-gray-600">Real biological data is often irregularly sampled due to missed measurements, instrument downtime, or event-driven data collection. Standard FFT requires uniform sampling intervals.</p>
                    <div class="mt-3 p-2 bg-purple-50 border-l-2 border-purple-400 rounded">
                        <p class="text-xs text-purple-900"><strong>Solution:</strong> Use <strong>Lomb-Scargle Periodogram</strong> - the gold standard in biology (used by MetaCycle)</p>
                    </div>
                </div>
            </div>
            
            <div class="max-w-4xl mx-auto bg-amber-50 border-2 border-amber-300 rounded-lg p-6">
                <h4 class="font-semibold text-amber-900 mb-3 text-center">‚ö° Critical Insight from Research</h4>
                <p class="text-sm text-amber-900 text-center leading-relaxed">
                    The challenges above are not theoretical‚Äîthey're the <strong>daily reality of biological data</strong>. 
                    Traditional Z-Transform and FFT were designed for engineered systems (electronics, control systems) with 
                    <strong>linear, stationary, uniformly-sampled</strong> signals. Biology violates all three assumptions! 
                    This is why specialized methods like Wavelets, Lomb-Scargle, and HOSA exist.
                </p>
            </div>
        </section>

        <section id="explorer" class="content-section">
            <h3 class="text-3xl font-bold text-center mb-2">Interactive Method Explorer</h3>
            <p class="text-center text-gray-500 mb-8">Select a biological signal type to see the recommended analysis method.</p>
            <div class="card max-w-5xl mx-auto">
                <div class="mb-6">
                    <label for="signal-type" class="block text-sm font-medium text-gray-700 mb-2">Biological Signal Type:</label>
                    <select id="signal-type" class="w-full p-3 border-2 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 font-medium">
                        <option value="stationary">Stationary Rhythmic Signal (e.g., Stable Heartbeat, Clean Filtered Data)</option>
                        <option value="irregular">Irregularly Sampled Data (e.g., Missing Timepoints, Field Measurements)</option>
                        <option value="nonstationary">Non-Stationary Signal (e.g., Cell Cycle Transitions, Aging)</option>
                        <option value="transient">Transient Event (e.g., Stress Response, Neural Spike)</option>
                        <option value="nonlinear">Nonlinear Coupling (e.g., Gene Networks, Multi-pathway Interactions)</option>
                    </select>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div>
                        <h4 id="recommendation-title" class="text-xl font-semibold mb-3 text-blue-600"></h4>
                        <p id="recommendation-text" class="text-gray-700 mb-4"></p>
                        
                        <div id="recommendation-details" class="space-y-3">
                            <!-- Details populated by JS -->
                        </div>
                        
                        <div id="recommendation-tools" class="mt-4 p-3 bg-blue-50 rounded-lg">
                            <p class="text-xs font-semibold text-blue-900 mb-1">Recommended Tools:</p>
                            <p id="tools-list" class="text-xs text-blue-800"></p>
                        </div>
                    </div>
                    <div>
                        <div class="chart-container" style="height: 250px;">
                            <canvas id="explorer-chart"></canvas>
                        </div>
                        <div id="chart-interpretation" class="mt-3 p-3 bg-gray-50 rounded-lg">
                            <p class="text-xs text-gray-700"></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="implementation" class="content-section">
            <h3 class="text-3xl font-bold text-center mb-2">Computational Implementation</h3>
            <p class="text-center text-gray-500 mb-12">Tools and Performance Considerations</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="card">
                    <h4 class="text-xl font-semibold mb-4">Software Libraries</h4>
                    <div class="space-y-4">
                        <div>
                            <h5 class="font-semibold">Python</h5>
                            <p class="text-sm text-gray-600">Libraries like <span class="font-mono bg-gray-100 px-1 rounded">scipy.signal</span>, <span class="font-mono bg-gray-100 px-1 rounded">numpy.fft</span>, and the <span class="font-mono bg-gray-100 px-1 rounded">python-control</span> library provide extensive tools for filtering, transformation, and system modeling.</p>
                        </div>
                        <div>
                            <h5 class="font-semibold">MATLAB</h5>
                            <p class="text-sm text-gray-600">The Signal Processing Toolbox and Control Systems Toolbox are industry standards for this type of analysis, offering robust functions and graphical interfaces for design and analysis.</p>
                        </div>
                         <div>
                            <h5 class="font-semibold">R / Bioconductor</h5>
                            <p class="text-sm text-gray-600">While less focused on control theory, packages within Bioconductor offer specialized tools for biological sequence and time-series analysis, including wavelet-based methods.</p>
                        </div>
                    </div>
                </div>
                 <div class="card">
                    <h4 class="text-xl font-semibold mb-4 text-center">Conceptual Computational Cost</h4>
                    <div class="chart-container" style="height: 280px; max-height: 300px;">
                        <canvas id="complexity-chart"></canvas>
                    </div>
                    <p class="text-xs text-center text-gray-500 mt-2">FFT is highly efficient. Wavelet transforms can be more intensive, and methods like EMD are often computationally demanding.</p>
                </div>
            </div>
        </section>
        
        <section id="conclusion" class="content-section">
            <div class="bg-gradient-to-br from-blue-50 to-purple-50 border-2 border-blue-200 rounded-lg p-8 mb-8">
                <h3 class="text-2xl font-bold text-center mb-4 text-blue-800">Conclusion: The Four-Lens Necessity</h3>
                <p class="text-center text-blue-900 mb-6">
                    No single transform is universally optimal for the diverse challenges in biological data analysis. The research is clear: 
                    biological systems violate the assumptions of classical signal processing methods.
                </p>
                
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white p-4 rounded-lg border border-blue-200">
                        <h4 class="font-semibold text-blue-800 mb-2">‚ùå What Fails</h4>
                        <ul class="text-sm text-blue-900 space-y-1">
                            <li>‚Ä¢ <strong>FFT alone:</strong> Fails on irregular sampling</li>
                            <li>‚Ä¢ <strong>Z-Transform alone:</strong> Assumes linearity (biology is nonlinear)</li>
                            <li>‚Ä¢ <strong>Fourier alone:</strong> Cannot handle non-stationary signals</li>
                            <li>‚Ä¢ <strong>Single method:</strong> Misses critical biological phenomena</li>
                        </ul>
                    </div>
                    
                    <div class="bg-white p-4 rounded-lg border border-green-200">
                        <h4 class="font-semibold text-green-800 mb-2">‚úÖ What Works</h4>
                        <ul class="text-sm text-green-900 space-y-1">
                            <li>‚Ä¢ <strong>Lomb-Scargle:</strong> Handles irregular sampling</li>
                            <li>‚Ä¢ <strong>Wavelet:</strong> Detects transients and non-stationarity</li>
                            <li>‚Ä¢ <strong>HOSA:</strong> Reveals nonlinear coupling</li>
                            <li>‚Ä¢ <strong>Multi-algorithm consensus:</strong> Fault tolerance (MetaCycle approach)</li>
                        </ul>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-cyan-100 to-blue-100 p-6 rounded-lg border-2 border-cyan-400">
                    <h4 class="font-bold text-center text-cyan-900 mb-3">üéØ The BioXen Four-Lens System</h4>
                    <p class="text-sm text-cyan-900 text-center leading-relaxed mb-4">
                        By integrating <strong>Fourier (Lomb-Scargle)</strong>, <strong>Wavelet</strong>, <strong>Laplace</strong>, 
                        and <strong>Z-Transform</strong> into a unified framework, the BioXen library empowers researchers to 
                        select the appropriate tool for their biological problem. This isn't theoretical‚Äîit's based on extensive 
                        peer-reviewed research showing these methods are <em>complementary, not competing</em>.
                    </p>
                    <p class="text-xs text-cyan-800 text-center font-medium">
                        See the <a href="bioxen-lenses.html" class="underline hover:text-cyan-600">BioXen Four-Lens Interactive Demo</a> 
                        to explore how each lens reveals different insights from the same data.
                    </p>
                </div>
            </div>
        </section>

    </main>
    </div>

    <footer class="bg-gray-100 mt-20">
        <div class="container mx-auto px-6 py-4 text-center text-gray-500">
            <p>A conceptual web application based on a literature review for the BioXen Fourier VM Library project.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sidebarNavLinks = document.querySelectorAll('.sidebar-nav-link');
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            const contentSections = document.querySelectorAll('.content-section');

            const explorerSelect = document.getElementById('signal-type');
            const recommendationTitle = document.getElementById('recommendation-title');
            const recommendationText = document.getElementById('recommendation-text');
            let explorerChart;
            let complexityChart;

            // Sidebar toggle functionality
            sidebarToggle.addEventListener('click', () => {
                sidebar.classList.toggle('sidebar-open');
                mainContent.classList.toggle('sidebar-open');
                document.getElementById('sidebar-overlay').classList.toggle('hidden');
            });

            // Close sidebar when clicking overlay
            document.getElementById('sidebar-overlay').addEventListener('click', () => {
                sidebar.classList.remove('sidebar-open');
                mainContent.classList.remove('sidebar-open');
                document.getElementById('sidebar-overlay').classList.add('hidden');
            });

            function switchMainTab(targetId) {
                sidebarNavLinks.forEach(link => {
                    link.classList.toggle('active', link.dataset.target === targetId);
                });
                contentSections.forEach(section => {
                    section.classList.toggle('active', section.id === targetId);
                });
            }
            
            sidebarNavLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = e.currentTarget.dataset.target;
                    switchMainTab(targetId);
                    
                    // Close sidebar on mobile after navigation
                    if (window.innerWidth < 768) {
                        sidebar.classList.remove('sidebar-open');
                        mainContent.classList.remove('sidebar-open');
                    }
                });
            });

            const chartData = {
                stationary: {
                    title: '‚úÖ Recommended: Standard FFT / Z-Transform',
                    text: 'For signals that are stable over time with clear, consistent frequencies, the Fast Fourier Transform (FFT) or Z-Transform are highly efficient and effective.',
                    details: [
                        { label: 'Why it works', text: 'Signal is stationary (frequency content doesn\'t change over time)' },
                        { label: 'Assumptions met', text: 'Uniform sampling, linear system, periodic behavior' },
                        { label: 'Computational cost', text: 'O(N log N) - very efficient' }
                    ],
                    tools: 'scipy.fft, numpy.fft, MATLAB FFT',
                    interpretation: 'Dominant frequencies clearly visible in power spectrum',
                    chart: {
                        type: 'line',
                        data: {
                            labels: Array.from({ length: 100 }, (_, i) => i),
                            datasets: [{
                                label: 'Signal',
                                data: Array.from({ length: 100 }, (_, i) => Math.sin(i * 0.3) + 0.2 * Math.sin(i * 0.7)),
                                borderColor: '#3b82f6',
                                borderWidth: 2,
                                pointRadius: 0,
                                tension: 0.1,
                            }]
                        },
                        options: {
                            plugins: { title: { display: true, text: 'Stable Periodic Signal' } }
                        }
                    }
                },
                irregular: {
                    title: '‚≠ê Recommended: Lomb-Scargle Periodogram',
                    text: 'When sampling is irregular (missing data points, uneven intervals), standard FFT fails. Lomb-Scargle is the gold standard in biology for handling this.',
                    details: [
                        { label: 'Biology standard', text: 'Used by MetaCycle (peer-reviewed tool for circadian analysis)' },
                        { label: 'Key advantage', text: 'Works on unevenly sampled data + provides statistical significance' },
                        { label: 'When to use', text: 'Field measurements, missed observations, event-driven sampling' }
                    ],
                    tools: 'astropy.timeseries.LombScargle, scipy.signal.lombscargle',
                    interpretation: 'Can detect rhythms even with 30%+ missing data points',
                    chart: {
                        type: 'scatter',
                        data: {
                            labels: Array.from({ length: 100 }, (_, i) => i),
                            datasets: [{
                                label: 'Signal',
                                data: Array.from({ length: 100 }, (_, i) => {
                                    if (Math.random() > 0.3) {
                                        return { x: i, y: Math.sin(i * 0.3) + 0.3 * (Math.random() - 0.5) };
                                    }
                                    return null;
                                }).filter(d => d !== null),
                                borderColor: '#8b5cf6',
                                backgroundColor: '#8b5cf6',
                                pointRadius: 3,
                            }]
                        },
                        options: {
                            plugins: { title: { display: true, text: 'Irregularly Sampled Data' } }
                        }
                    }
                },
                nonstationary: {
                    title: 'üåä Recommended: Wavelet Transform (ESSENTIAL)',
                    text: 'When frequency content changes over time (cell cycle transitions, aging, adaptation), Fourier analysis fails completely. Wavelets provide time-frequency localization.',
                    details: [
                        { label: 'Critical for biology', text: 'Cells change states - metabolism speeds up/slows down dynamically' },
                        { label: 'What it reveals', text: 'Not just WHAT frequencies exist, but WHEN they occur' },
                        { label: 'Research backed', text: 'Essential for transient phenomena and damping oscillations' }
                    ],
                    tools: 'pywt (PyWavelets), scipy.signal.cwt, MATLAB Wavelet Toolbox',
                    interpretation: 'Scalogram shows frequency evolution over time - Fourier cannot do this',
                    chart: {
                        type: 'line',
                        data: {
                            labels: Array.from({ length: 100 }, (_, i) => i),
                            datasets: [{
                                label: 'Signal',
                                data: Array.from({ length: 100 }, (_, i) => Math.sin(i * (0.1 + i*0.004)) * Math.exp(-i*0.01)),
                                borderColor: '#0891b2',
                                borderWidth: 2,
                                pointRadius: 0,
                                tension: 0.1,
                            }]
                        },
                        options: {
                            plugins: { title: { display: true, text: 'Frequency + Amplitude Change Over Time' } }
                        }
                    }
                },
                transient: {
                    title: '‚ö° Recommended: Wavelet Transform',
                    text: 'For short, sharp, non-periodic events (stress response, neural spikes, gene bursts), Fourier analysis performs terribly. Wavelets excel at localizing these events in time.',
                    details: [
                        { label: 'Why Fourier fails', text: 'FFT assumes signal repeats forever - transient events are NOT periodic' },
                        { label: 'Wavelet advantage', text: 'Pinpoints exact moment of event occurrence' },
                        { label: 'Biological examples', text: 'Heat shock response, action potentials, transcription bursts' }
                    ],
                    tools: 'pywt, scipy.signal.cwt, per2py (single-cell analysis)',
                    interpretation: 'Wavelet detects transient at exact time; Fourier smears it across entire window',
                    chart: {
                        type: 'line',
                        data: {
                            labels: Array.from({ length: 100 }, (_, i) => i),
                            datasets: [{
                                label: 'Signal',
                                data: Array.from({ length: 100 }, (_, i) => (i > 45 && i < 55) ? Math.exp(-Math.pow(i - 50, 2) / 4) : 0.05 * (Math.random() - 0.5)),
                                borderColor: '#ef4444',
                                borderWidth: 2,
                                pointRadius: 0,
                                tension: 0.1,
                            }]
                        },
                        options: {
                            plugins: { title: { display: true, text: 'Transient Event (t ‚âà 50)' } }
                        }
                    }
                },
                nonlinear: {
                    title: 'üî¨ Recommended: Higher-Order Spectral Analysis (HOSA)',
                    text: 'Biological systems exhibit nonlinear interactions (gene networks, metabolic pathways). Standard Fourier/Z-Transform assume linearity and miss these couplings.',
                    details: [
                        { label: 'The problem', text: 'Two frequencies (12h + 8h cycles) can phase-lock to create 24h rhythm' },
                        { label: 'What HOSA detects', text: 'Bispectrum/Bicoherence reveal quadratic phase coupling' },
                        { label: 'When critical', text: 'Multi-pathway regulation, cooperative binding, feedback loops' }
                    ],
                    tools: 'Custom implementations, statsmodels (partial), MATLAB HOSA Toolbox',
                    interpretation: 'Bispectrum peak indicates two frequencies are coupled nonlinearly',
                    chart: {
                        type: 'line',
                        data: {
                            labels: Array.from({ length: 100 }, (_, i) => i),
                            datasets: [{
                                label: 'Signal',
                                data: Array.from({ length: 100 }, (_, i) => {
                                    const f1 = Math.sin(i * 0.2);
                                    const f2 = Math.sin(i * 0.3);
                                    return f1 + f2 + 0.3 * f1 * f2; // Nonlinear coupling
                                }),
                                borderColor: '#f59e0b',
                                borderWidth: 2,
                                pointRadius: 0,
                                tension: 0.1,
                            }]
                        },
                        options: {
                            plugins: { title: { display: true, text: 'Nonlinearly Coupled Oscillations' } }
                        }
                    }
                }
            };
            
            function updateExplorer(selectedValue) {
                const content = chartData[selectedValue];
                recommendationTitle.textContent = content.title;
                recommendationText.textContent = content.text;
                
                // Update details
                const detailsDiv = document.getElementById('recommendation-details');
                detailsDiv.innerHTML = content.details.map(detail => `
                    <div class="border-l-3 border-blue-400 pl-3">
                        <p class="text-xs font-semibold text-gray-700">${detail.label}:</p>
                        <p class="text-xs text-gray-600">${detail.text}</p>
                    </div>
                `).join('');
                
                // Update tools
                document.getElementById('tools-list').textContent = content.tools;
                
                // Update interpretation
                document.querySelector('#chart-interpretation p').textContent = content.interpretation;

                if (explorerChart) {
                    explorerChart.destroy();
                }

                const ctx = document.getElementById('explorer-chart').getContext('2d');
                explorerChart = new Chart(ctx, {
                    type: content.chart.type,
                    data: content.chart.data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { 
                            y: { beginAtZero: false }, 
                            x: { display: false } 
                        },
                        plugins: { 
                            legend: { display: false },
                            ...content.chart.options.plugins
                        }
                    }
                });
            }

            explorerSelect.addEventListener('change', (event) => {
                updateExplorer(event.target.value);
            });
            
            updateExplorer('stationary');

            const complexityCtx = document.getElementById('complexity-chart').getContext('2d');
            complexityChart = new Chart(complexityCtx, {
                type: 'bar',
                data: {
                    labels: ['FFT (N log N)', 'Wavelet', 'EMD'],
                    datasets: [{
                        label: 'Relative Cost',
                        data: [20, 50, 90],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.7)',
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(239, 68, 68, 0.7)',
                        ],
                        borderColor: [
                             'rgba(59, 130, 246, 1)',
                            'rgba(16, 185, 129, 1)',
                            'rgba(239, 68, 68, 1)',
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: { display: false }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });
        });
    </script>

    <footer class="mt-16 py-8 border-t border-gray-200 bg-gradient-to-r from-stone-50 to-stone-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-4">
                <h3 class="text-lg font-semibold text-stone-800 mb-3">üìö Research Foundation & Documentation</h3>
                <div class="grid md:grid-cols-3 gap-4 max-w-4xl mx-auto">
                    <a href="../research/Biological Signal Analysis_ Z-Transform & Alternatives.md" 
                       class="block bg-white hover:bg-purple-50 border-2 border-purple-200 hover:border-purple-400 rounded-lg p-3 transition-all">
                        <div class="text-purple-600 font-medium">Biological Signal Analysis</div>
                        <div class="text-xs text-stone-600 mt-1">Z-Transform limitations & alternatives</div>
                    </a>
                    <a href="../research/Frequency Domain Analysis in Biology.md" 
                       class="block bg-white hover:bg-green-50 border-2 border-green-200 hover:border-green-400 rounded-lg p-3 transition-all">
                        <div class="text-green-600 font-medium">Frequency Domain Analysis</div>
                        <div class="text-xs text-stone-600 mt-1">Spectral methods for biology</div>
                    </a>
                    <a href="../../../../new-prompt-update-execution-model-research-addendum.md" 
                       class="block bg-white hover:bg-cyan-50 border-2 border-cyan-200 hover:border-cyan-400 rounded-lg p-3 transition-all">
                        <div class="text-cyan-600 font-medium">Research Addendum ‚≠ê</div>
                        <div class="text-xs text-stone-600 mt-1">Latest enhancements (Wavelet, HOSA)</div>
                    </a>
                </div>
            </div>
            <div class="text-center text-sm text-stone-600 border-t border-stone-200 pt-4">
                <p><strong>BioSignal Analysis Guide</strong> | Version 2.0 (Research-Enhanced) | 
                <span class="text-purple-600">Updated with Four-Lens Methodology</span></p>
                <p class="mt-2 text-xs">Based on peer-reviewed research: MetaCycle, Lomb-Scargle periodograms, wavelet analysis for non-stationary signals, and HOSA for nonlinear systems</p>
            </div>
        </div>
    </footer>
</body>
</html>
